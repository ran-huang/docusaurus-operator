<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.16">
<title data-rh="true">Get Started With TiDB Operator in Kubernetes | TiDB in Kubernetes Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ran-huang.github.io/docusaurus-operator/get-started"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Get Started With TiDB Operator in Kubernetes | TiDB in Kubernetes Docs"><meta data-rh="true" name="description" content="This document introduces how to create a simple Kubernetes cluster and use it to deploy a basic test TiDB cluster using TiDB Operator."><meta data-rh="true" property="og:description" content="This document introduces how to create a simple Kubernetes cluster and use it to deploy a basic test TiDB cluster using TiDB Operator."><link data-rh="true" rel="icon" href="/docusaurus-operator/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ran-huang.github.io/docusaurus-operator/get-started"><link data-rh="true" rel="alternate" href="https://ran-huang.github.io/docusaurus-operator/get-started" hreflang="en"><link data-rh="true" rel="alternate" href="https://ran-huang.github.io/docusaurus-operator/get-started" hreflang="x-default"><link rel="stylesheet" href="/docusaurus-operator/assets/css/styles.732b35c1.css">
<link rel="preload" href="/docusaurus-operator/assets/js/runtime~main.b87ef9bf.js" as="script">
<link rel="preload" href="/docusaurus-operator/assets/js/main.51dee141.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docusaurus-operator/"><div class="navbar__logo"><img src="/docusaurus-operator/img/tidb-logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/docusaurus-operator/img/tidb-logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">TiDB in Kubernetes</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docusaurus-operator/">Docs</a><a class="navbar__item navbar__link" href="/docusaurus-operator/architecture">Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ran-huang/docs-tidb-operator" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">🌜</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">🌞</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode (currently light mode)"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docusaurus-operator/">TiDB in Kubernetes</a><button aria-label="Toggle the collapsible sidebar category &#x27;TiDB in Kubernetes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docusaurus-operator/get-started">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docusaurus-operator/prerequisites">Deploy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docusaurus-operator/restore-data-using-tidb-lightning">Migrate</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docusaurus-operator/enable-tls-for-mysql-client">Manage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docusaurus-operator/tips">Troubleshoot</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docusaurus-operator/faq">TiDB FAQs in Kubernetes</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docusaurus-operator/get-started">Getting Started</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Get Started with TiDB Operator in Kubernetes</h1><p>This document introduces how to create a simple Kubernetes cluster and use it to deploy a basic test TiDB cluster using TiDB Operator.</p><div class="admonition admonition-danger alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Warning</h5></div><div class="admonition-content"><p>This document is for demonstration purposes only. <strong>Do not</strong> follow it in production environments. For deployment in production environments, see the instructions in <a href="#see-also">See also</a>.</p></div></div><p>You can follow these steps to deploy TiDB Operator and a TiDB cluster:</p><ol><li><a href="#step-1-create-a-test-kubernetes-cluster">Create a test Kubernetes cluster</a></li><li><a href="#step-2-deploy-tidb-operator">Deploy TiDB Operator</a></li><li><a href="#step-3-deploy-a-tidb-cluster-and-its-monitoring-services">Deploy a TiDB cluster and its monitoring services</a></li><li><a href="#step-4-connect-to-tidb">Connect to a TiDB cluster</a></li><li><a href="#step-5-upgrade-a-tidb-cluster">Upgrade a TiDB cluster</a></li><li><a href="#step-6-destroy-the-tidb-cluster-and-the-kubernetes-cluster">Destroy the TiDB cluster and the Kubernetes cluster</a></li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="step-1-create-a-test-kubernetes-cluster">Step 1. Create a test Kubernetes cluster<a class="hash-link" href="#step-1-create-a-test-kubernetes-cluster" title="Direct link to heading">​</a></h2><p>This section describes two ways to create a simple Kubernetes cluster. After creating a Kubernetes cluster, you can use it to test TiDB clusters managed by TiDB Operator. Choose whichever best matches your environment.</p><ul><li><a href="#create-a-kubernetes-cluster-using-kind">Use kind</a> to deploy a Kubernetes cluster in Docker. It is a common and recommended way.</li><li><a href="#create-a-kubernetes-cluster-using-minikube">Use minikube</a> to deploy a Kubernetes cluster running locally in a VM.</li></ul><p>Alternatively, you can deploy a Kubernetes cluster in Google Kubernetes Engine in Google Cloud Platform using the <a href="https://console.cloud.google.com/cloudshell/open?cloudshell_git_repo=https://github.com/pingcap/docs-tidb-operator&amp;cloudshell_tutorial=en/deploy-tidb-from-kubernetes-gke.md" target="_blank" rel="noopener noreferrer">Google Cloud Shell</a>.</p><div><div label="kind"><h3 class="anchor anchorWithStickyNavbar_mojV" id="create-a-kubernetes-cluster-using-kind">Create a Kubernetes cluster using kind<a class="hash-link" href="#create-a-kubernetes-cluster-using-kind" title="Direct link to heading">​</a></h3><p>This section shows how to deploy a Kubernetes cluster using <a href="https://kind.sigs.k8s.io/" target="_blank" rel="noopener noreferrer">kind</a>.</p><p>kind is a popular tool for running local Kubernetes clusters using Docker containers as cluster nodes. For available tags, see <a href="https://hub.docker.com/r/kindest/node/tags" target="_blank" rel="noopener noreferrer">Docker Hub</a>. The latest version of kind is used by default.</p><p>Before deployment, make sure the following requirements are satisfied:</p><ul><li><a href="https://docs.docker.com/install/" target="_blank" rel="noopener noreferrer">Docker</a>: version &gt;= 17.03</li><li><a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" target="_blank" rel="noopener noreferrer">kubectl</a>: version &gt;= 1.12</li><li><a href="https://kind.sigs.k8s.io/docs/user/quick-start/" target="_blank" rel="noopener noreferrer">kind</a>: version &gt;= 0.8.0</li><li>For Linux, the value of the sysctl parameter <a href="https://linuxconfig.org/how-to-turn-on-off-ip-forwarding-in-linux" target="_blank" rel="noopener noreferrer">net.ipv4.ip_forward</a> should be set to <code>1</code>.</li></ul><p>The following is an example of using <code>kind</code> v0.8.1:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kind create cluster</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Creating cluster &quot;kind&quot; ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ✓ Ensuring node image (kindest/node:v1.18.2) 🖼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ✓ Preparing nodes 📦</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ✓ Writing configuration 📜</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ✓ Starting control-plane 🕹️</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ✓ Installing CNI 🔌</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ✓ Installing StorageClass 💾</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Set kubectl context to &quot;kind-kind&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">You can now use your cluster with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl cluster-info --context kind-kind</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Thanks for using kind! 😊</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><p>Check whether the cluster is successfully created:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl cluster-info</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Kubernetes master is running at https://127.0.0.1:51026</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KubeDNS is running at https://127.0.0.1:51026/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To further debug and diagnose cluster problems, use &#x27;kubectl cluster-info dump&#x27;.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><p>You are now ready to deploy TiDB Operator.</p></div><div label="minikube"><h3 class="anchor anchorWithStickyNavbar_mojV" id="create-a-kubernetes-cluster-using-minikube">Create a Kubernetes cluster using minikube<a class="hash-link" href="#create-a-kubernetes-cluster-using-minikube" title="Direct link to heading">​</a></h3><p>You can create a Kubernetes cluster in a VM using <a href="https://minikube.sigs.k8s.io/docs/start/" target="_blank" rel="noopener noreferrer">minikube</a>, which supports macOS, Linux, and Windows.</p><p>Before deployment, make sure the following requirements are satisfied:</p><ul><li><a href="https://minikube.sigs.k8s.io/docs/start/" target="_blank" rel="noopener noreferrer">minikube</a>: version 1.0.0 or later versions. Newer versions like v1.24 is recommended. minikube requires a compatible hypervisor. For details, refer to minikube installation instructions.</li><li><a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" target="_blank" rel="noopener noreferrer">kubectl</a>: version &gt;= 1.12</li></ul><h4 class="anchor anchorWithStickyNavbar_mojV" id="start-a-minikube-kubernetes-cluster">Start a minikube Kubernetes cluster<a class="hash-link" href="#start-a-minikube-kubernetes-cluster" title="Direct link to heading">​</a></h4><p>After minikube is installed, run the following command to start a minikube Kubernetes cluster:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">minikube start</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q">You should see output like this, with some differences depending on your OS and hypervisor:<div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">😄  minikube v1.24.0 on Darwin 12.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✨  Automatically selected the docker driver. Other choices: hyperkit, virtualbox, ssh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">👍  Starting control plane node minikube in cluster minikube</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">🚜  Pulling base image ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">💾  Downloading Kubernetes v1.22.3 preload ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt; gcr.io/k8s-minikube/kicbase: 355.78 MiB / 355.78 MiB  100.00% 4.46 MiB p/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt; preloaded-images-k8s-v13-v1...: 501.73 MiB / 501.73 MiB  100.00% 5.18 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">🔥  Creating docker container (CPUs=2, Memory=1985MB) ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">🐳  Preparing Kubernetes v1.22.3 on Docker 20.10.8 ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ▪ Generating certificates and keys ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ▪ Booting up control plane ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ▪ Configuring RBAC rules ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">🔎  Verifying Kubernetes components...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ▪ Using image gcr.io/k8s-minikube/storage-provisioner:v5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">🌟  Enabled addons: storage-provisioner, default-storageclass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">🏄  Done! kubectl is now configured to use &quot;minikube&quot; cluster and &quot;default&quot; namespace by default</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><h4 class="anchor anchorWithStickyNavbar_mojV" id="use-kubectl-to-interact-with-the-cluster">Use <code>kubectl</code> to interact with the cluster<a class="hash-link" href="#use-kubectl-to-interact-with-the-cluster" title="Direct link to heading">​</a></h4><p>To interact with the cluster, you can use <code>kubectl</code>, which is included as a sub-command in <code>minikube</code>. To make the <code>kubectl</code> command available, you can either add the following alias definition command to your shell profile, or run the following alias definition command after opening a new shell.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">alias kubectl=&#x27;minikube kubectl --&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Run the following command to check the status of Kubernetes and ensure that <code>kubectl</code> can connect to it:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl cluster-info</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Kubernetes master is running at https://192.168.64.2:8443</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KubeDNS is running at https://192.168.64.2:8443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To further debug and diagnose cluster problems, use &#x27;kubectl cluster-info dump&#x27;.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><p>You are now ready to deploy TiDB Operator.</p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="step-2-deploy-tidb-operator">Step 2. Deploy TiDB Operator<a class="hash-link" href="#step-2-deploy-tidb-operator" title="Direct link to heading">​</a></h2><p>You need to install TiDB Operator CRDs first, and then install TiDB Operator.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="install-tidb-operator-crds">Install TiDB Operator CRDs<a class="hash-link" href="#install-tidb-operator-crds" title="Direct link to heading">​</a></h3><p>TiDB Operator includes a number of Custom Resource Definitions (CRDs) that implement different components of the TiDB cluster.</p><p>Run the following command to install the CRDs into your cluster:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f https://raw.githubusercontent.com/pingcap/tidb-operator/v1.2.4/manifests/crd.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">customresourcedefinition.apiextensions.k8s.io/tidbclusters.pingcap.com created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">customresourcedefinition.apiextensions.k8s.io/backups.pingcap.com created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">customresourcedefinition.apiextensions.k8s.io/restores.pingcap.com created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">customresourcedefinition.apiextensions.k8s.io/backupschedules.pingcap.com created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">customresourcedefinition.apiextensions.k8s.io/tidbmonitors.pingcap.com created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">customresourcedefinition.apiextensions.k8s.io/tidbinitializers.pingcap.com created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">customresourcedefinition.apiextensions.k8s.io/tidbclusterautoscalers.pingcap.com created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>For Kubernetes earlier than 1.16, only v1beta1 CRD is supported. Therefore, you need to change <code>crd.yaml</code> in the preceding command to <code>crd_v1beta1.yaml</code>.</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="install-tidb-operator">Install TiDB Operator<a class="hash-link" href="#install-tidb-operator" title="Direct link to heading">​</a></h3><p>This section describes how to install TiDB Operator using <a href="https://helm.sh/docs/intro/install/" target="_blank" rel="noopener noreferrer">Helm 3</a>.</p><ol><li><p>Add the PingCAP repository:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">helm repo </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> pingcap https://charts.pingcap.org/</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;pingcap&quot; has been added to your repositories</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details></li><li><p>Create a namespace for TiDB Operator:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create namespace tidb-admin</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">namespace/tidb-admin created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details></li><li><p>Install TiDB Operator</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">helm </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> --namespace tidb-admin tidb-operator pingcap/tidb-operator --version v1.2.7</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">NAME: tidb-operator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LAST DEPLOYED: Mon Jun  1 12:31:43 2020</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAMESPACE: tidb-admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">STATUS: deployed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REVISION: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TEST SUITE: None</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NOTES:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Make sure tidb-operator components are running:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kubectl get pods --namespace tidb-admin -l app.kubernetes.io/instance=tidb-operator</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details></li></ol><p>To confirm that the TiDB Operator components are running, run the following command:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods --namespace tidb-admin -l app.kubernetes.io/instance</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tidb-operator</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                       READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tidb-controller-manager-6d8d5c6d64-b8lv4   1/1     Running   0          2m22s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tidb-scheduler-644d59b46f-4f6sb            2/2     Running   0          2m22s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><p>As soon as all Pods are in the &quot;Running&quot; state, proceed to the next step.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="step-3-deploy-a-tidb-cluster-and-its-monitoring-services">Step 3. Deploy a TiDB cluster and its monitoring services<a class="hash-link" href="#step-3-deploy-a-tidb-cluster-and-its-monitoring-services" title="Direct link to heading">​</a></h2><p>This section describes how to deploy a TiDB cluster and its monitoring services.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="deploy-a-tidb-cluster">Deploy a TiDB cluster<a class="hash-link" href="#deploy-a-tidb-cluster" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create namespace tidb-cluster </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kubectl -n tidb-cluster apply -f https://raw.githubusercontent.com/pingcap/tidb-operator/master/examples/basic/tidb-cluster.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">namespace/tidb-cluster created</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tidbcluster.pingcap.com/basic created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><p>If you need to deploy a TiDB cluster on an ARM64 machine, refer to <a href="/docusaurus-operator/deploy-cluster-on-arm64">Deploy a TiDB Cluster on ARM64 Machines</a>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="deploy-tidb-monitoring-services">Deploy TiDB monitoring services<a class="hash-link" href="#deploy-tidb-monitoring-services" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl -n tidb-cluster apply -f https://raw.githubusercontent.com/pingcap/tidb-operator/master/examples/basic/tidb-monitor.yaml</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">tidbmonitor.pingcap.com/basic created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><h3 class="anchor anchorWithStickyNavbar_mojV" id="view-the-pod-status">View the Pod status<a class="hash-link" href="#view-the-pod-status" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">watch</span><span class="token plain"> kubectl get po -n tidb-cluster</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">NAME                              READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-discovery-6bb656bfd-xl5pb   1/1     Running   0          9m9s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-monitor-5fc8589c89-gvgjj    3/3     Running   0          8m58s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-pd-0                        1/1     Running   0          9m8s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-tidb-0                      2/2     Running   0          7m14s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-tikv-0                      1/1     Running   0          8m13s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><p>Wait until all Pods for all services are started. As soon as you see Pods of each type (<code>-pd</code>, <code>-tikv</code>, and <code>-tidb</code>) are in the &quot;Running&quot; state, you can press <kbd>Ctrl</kbd>+<kbd>C</kbd> to get back to the command line and go on to connect to your TiDB cluster.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="step-4-connect-to-tidb">Step 4. Connect to TiDB<a class="hash-link" href="#step-4-connect-to-tidb" title="Direct link to heading">​</a></h2><p>Because TiDB supports the MySQL protocol and most of its syntax, you can connect to TiDB using the MySQL client.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="install-the-mysql-client">Install the MySQL client<a class="hash-link" href="#install-the-mysql-client" title="Direct link to heading">​</a></h3><p>To connect to TiDB, you need a MySQL-compatible client installed on the host where <code>kubectl</code> is installed. This can be the <code>mysql</code> executable from an installation of MySQL Server, MariaDB Server, Percona Server, or a standalone client executable from the package of your operating system.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="forward-port-4000">Forward port 4000<a class="hash-link" href="#forward-port-4000" title="Direct link to heading">​</a></h3><p>You can connect to TiDB by first forwarding a port from the local host to the TiDB <strong>service</strong> in Kubernetes.</p><p>First, get a list of services in the <code>tidb-cluster</code> namespace:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get svc -n tidb-cluster</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">NAME                     TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)              AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-discovery          ClusterIP   10.101.69.5      &lt;none&gt;        10261/TCP            10m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-grafana            ClusterIP   10.106.41.250    &lt;none&gt;        3000/TCP             10m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-monitor-reloader   ClusterIP   10.99.157.225    &lt;none&gt;        9089/TCP             10m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-pd                 ClusterIP   10.104.43.232    &lt;none&gt;        2379/TCP             10m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-pd-peer            ClusterIP   None             &lt;none&gt;        2380/TCP             10m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-prometheus         ClusterIP   10.106.177.227   &lt;none&gt;        9090/TCP             10m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-tidb               ClusterIP   10.99.24.91      &lt;none&gt;        4000/TCP,10080/TCP   8m40s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-tidb-peer          ClusterIP   None             &lt;none&gt;        10080/TCP            8m40s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-tikv-peer          ClusterIP   None             &lt;none&gt;        20160/TCP            9m39s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><p>In this case, the TiDB <strong>service</strong> is called <strong>basic-tidb</strong>. Run the following command to forward this port from the local host to the cluster:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl port-forward -n tidb-cluster svc/basic-tidb </span><span class="token number" style="color:#36acaa">14000</span><span class="token plain">:4000 </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pf14000.out </span><span class="token operator" style="color:#393A34">&amp;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>If the port <code>14000</code> is already occupied, you can replace it with an available port. This command runs in the background and writes its output to a file named <code>pf14000.out</code>. You can continue to run the command in the current shell session.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="connect-to-the-tidb-service">Connect to the TiDB service<a class="hash-link" href="#connect-to-the-tidb-service" title="Direct link to heading">​</a></h3><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>To connect to TiDB (&lt; v4.0.7) using a MySQL 8.0 client, if the user account has a password, you must explicitly specify <code>--default-auth=mysql_native_password</code>. This is because <code>mysql_native_password</code> is <a href="https://dev.mysql.com/doc/refman/8.0/en/upgrading-from-previous-series.html#upgrade-caching-sha2-password" target="_blank" rel="noopener noreferrer">no longer the default plugin</a>.</p></div></div><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">mysql --comments -h </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1 -P </span><span class="token number" style="color:#36acaa">14000</span><span class="token plain"> -u root</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Your MySQL connection id is 76</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server version: 5.7.25-TiDB-v4.0.0 MySQL Community Server (Apache License 2.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Oracle is a registered trademark of Oracle Corporation and/or its</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">affiliates. Other names may be trademarks of their respective</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">owners.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type &#x27;help;&#x27; or &#x27;\h&#x27; for help. Type &#x27;\c&#x27; to clear the current input statement.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mysql&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><p>After connecting to the cluster, you can run the following commands to verify that some features available in TiDB. Note that some commands require TiDB 4.0 or higher versions. If you have deployed an earlier version, you need to <a href="#step-5-upgrade-a-tidb-cluster">upgrade the TiDB cluster</a>.</p><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Create a <code>hello_world</code> table</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">mysql</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> test</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mysql</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">create</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">table</span><span class="token plain"> hello_world </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">unsigned</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">not</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">null</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">auto_increment</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">primary</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v </span><span class="token keyword" style="color:#00009f">varchar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">rows</span><span class="token plain"> affected </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.17</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mysql</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tikv_region_status </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> db_name</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">database</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> table_name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;hello_world&#x27;</span><span class="token plain">\G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       REGION_ID: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       START_KEY: </span><span class="token number" style="color:#36acaa">7480000000000000</span><span class="token plain">FF3700000000000000F8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         END_KEY:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TABLE_ID: </span><span class="token number" style="color:#36acaa">55</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         DB_NAME: test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      TABLE_NAME: hello_world</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        IS_INDEX: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INDEX_ID: </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      INDEX_NAME: </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  EPOCH_CONF_VER: </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   EPOCH_VERSION: </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   WRITTEN_BYTES: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      READ_BYTES: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">APPROXIMATE_SIZE: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">APPROXIMATE_KEYS: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.03</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Query the TiDB version</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">mysql</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> tidb_version</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tidb_version</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">: </span><span class="token keyword" style="color:#00009f">Release</span><span class="token plain"> Version: v5</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">3.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         Edition: Community</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Git </span><span class="token keyword" style="color:#00009f">Commit</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Hash</span><span class="token plain">: </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">a1b2e9fe5b5afb1068c56de47adb07098d768d6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Git Branch: heads</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">refs</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">tags</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">v5</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">3.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UTC Build </span><span class="token keyword" style="color:#00009f">Time</span><span class="token plain">: </span><span class="token number" style="color:#36acaa">2021</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">11</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">32</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">39</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       GoVersion: go1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">16.4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Race Enabled: </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TiKV Min Version: v3</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">0.0</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">60965</span><span class="token plain">b006877ca7234adaced7890d7b029ed1306</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">Check</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Table</span><span class="token plain"> Before </span><span class="token keyword" style="color:#00009f">Drop</span><span class="token plain">: </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.01</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Query the TiKV store status</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">mysql</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tikv_store_status\G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            STORE_ID: </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             ADDRESS: basic</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">tikv</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.</span><span class="token plain">basic</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">tikv</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">peer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tidb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">cluster</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">svc:</span><span class="token number" style="color:#36acaa">20160</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         STORE_STATE: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    STORE_STATE_NAME: Up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               LABEL: </span><span class="token boolean" style="color:#36acaa">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             VERSION: </span><span class="token number" style="color:#36acaa">5.2</span><span class="token number" style="color:#36acaa">.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            CAPACITY: </span><span class="token number" style="color:#36acaa">58.42</span><span class="token plain">GiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           AVAILABLE: </span><span class="token number" style="color:#36acaa">36.18</span><span class="token plain">GiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        LEADER_COUNT: </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       LEADER_WEIGHT: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        LEADER_SCORE: </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         LEADER_SIZE: </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        REGION_COUNT: </span><span class="token number" style="color:#36acaa">21</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       REGION_WEIGHT: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        REGION_SCORE: </span><span class="token number" style="color:#36acaa">21</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         REGION_SIZE: </span><span class="token number" style="color:#36acaa">21</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            START_TS: </span><span class="token number" style="color:#36acaa">2020</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">05</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">28</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">48</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">21</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   LAST_HEARTBEAT_TS: </span><span class="token number" style="color:#36acaa">2020</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">05</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">28</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">52</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">01</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              UPTIME: </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">m40</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">598302151</span><span class="token plain">s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">rows</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.01</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Query the TiDB cluster information</summary><div><div class="collapsibleContent_i85q"><p>This command is effective only in TiDB 4.0 or later versions. If your TiDB does not support the command, you need to <a href="#step-5-upgrade-a-tidb-cluster">Upgrade a TiDB cluster</a>.</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">mysql</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cluster_info\G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">TYPE</span><span class="token plain">: tidb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INSTANCE: basic</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">tidb</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.</span><span class="token plain">basic</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">tidb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">peer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tidb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">cluster</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">svc:</span><span class="token number" style="color:#36acaa">4000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  STATUS_ADDRESS: basic</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">tidb</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.</span><span class="token plain">basic</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">tidb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">peer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tidb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">cluster</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">svc:</span><span class="token number" style="color:#36acaa">10080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         VERSION: </span><span class="token number" style="color:#36acaa">5.2</span><span class="token number" style="color:#36acaa">.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GIT_HASH: </span><span class="token number" style="color:#36acaa">689</span><span class="token plain">a6b6439ae7835947fcaccf329a3fc303986cb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      START_TIME: </span><span class="token number" style="color:#36acaa">2020</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">05</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">28</span><span class="token plain">T22:</span><span class="token number" style="color:#36acaa">50</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">11</span><span class="token plain">Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          UPTIME: </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">m21</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">459090928</span><span class="token plain">s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">TYPE</span><span class="token plain">: pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INSTANCE: basic</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">pd:</span><span class="token number" style="color:#36acaa">2379</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  STATUS_ADDRESS: basic</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">pd:</span><span class="token number" style="color:#36acaa">2379</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         VERSION: </span><span class="token number" style="color:#36acaa">5.2</span><span class="token number" style="color:#36acaa">.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GIT_HASH: </span><span class="token number" style="color:#36acaa">56</span><span class="token plain">d4c3d2237f5bf6fb11a794731ed1d95c8020c2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      START_TIME: </span><span class="token number" style="color:#36acaa">2020</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">05</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">28</span><span class="token plain">T22:</span><span class="token number" style="color:#36acaa">45</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">04</span><span class="token plain">Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          UPTIME: </span><span class="token number" style="color:#36acaa">8</span><span class="token plain">m28</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">459091915</span><span class="token plain">s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">TYPE</span><span class="token plain">: tikv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        INSTANCE: basic</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">tikv</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.</span><span class="token plain">basic</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">tikv</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">peer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tidb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">cluster</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">svc:</span><span class="token number" style="color:#36acaa">20160</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  STATUS_ADDRESS: </span><span class="token number" style="color:#36acaa">0.0</span><span class="token number" style="color:#36acaa">.0</span><span class="token number" style="color:#36acaa">.0</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">20180</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         VERSION: </span><span class="token number" style="color:#36acaa">5.2</span><span class="token number" style="color:#36acaa">.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        GIT_HASH: </span><span class="token number" style="color:#36acaa">198</span><span class="token plain">a2cea01734ce8f46d55a29708f123f9133944</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      START_TIME: </span><span class="token number" style="color:#36acaa">2020</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">05</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">28</span><span class="token plain">T22:</span><span class="token number" style="color:#36acaa">48</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">21</span><span class="token plain">Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          UPTIME: </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">m11</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">459102648</span><span class="token plain">s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">rows</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.01</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><h3 class="anchor anchorWithStickyNavbar_mojV" id="access-the-grafana-dashboard">Access the Grafana dashboard<a class="hash-link" href="#access-the-grafana-dashboard" title="Direct link to heading">​</a></h3><p>You can forward the port for Grafana to access the Grafana dashboard locally:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl port-forward -n tidb-cluster svc/basic-grafana </span><span class="token number" style="color:#36acaa">3000</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pf3000.out </span><span class="token operator" style="color:#393A34">&amp;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>You can access the Grafana dashboard at <a href="http://localhost:3000" target="_blank" rel="noopener noreferrer">http://localhost:3000</a> on the host where you run <code>kubectl</code>. The default username and password in Grafana are both <code>admin</code>.</p><p>Note that if you run <code>kubectl</code> in a Docker container or on a remote host instead of your local host, you can not access the Grafana dashboard at <a href="http://localhost:3000" target="_blank" rel="noopener noreferrer">http://localhost:3000</a> from your browser. In this case, you can run the following command to listen on all addresses.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl port-forward --address </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0 -n tidb-cluster svc/basic-grafana </span><span class="token number" style="color:#36acaa">3000</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pf3000.out </span><span class="token operator" style="color:#393A34">&amp;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Then access Grafana through <a href="http://$%7Bremote-server-IP%7D:3000" target="_blank" rel="noopener noreferrer">http://${remote-server-IP}:3000</a>.</p><p>For more information about monitoring the TiDB cluster in TiDB Operator, refer to <a href="/docusaurus-operator/monitor-a-tidb-cluster">Deploy Monitoring and Alerts for a TiDB Cluster</a>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="step-5-upgrade-a-tidb-cluster">Step 5. Upgrade a TiDB cluster<a class="hash-link" href="#step-5-upgrade-a-tidb-cluster" title="Direct link to heading">​</a></h2><p>TiDB Operator also makes it easy to perform a rolling upgrade of the TiDB cluster. This section describes how to upgrade your TiDB cluster to the &quot;nightly&quot; release.</p><p>Before that, you need to get familiar with a <code>kubectl</code> sub-command <code>kubectl patch</code>. It applies a specification change directly to the running cluster resources. There are several different patch strategies, each of which has various capabilities, limitations, and allowed formats. For details, see <a href="https://kubernetes.io/docs/tasks/manage-kubernetes-objects/update-api-object-kubectl-patch/" target="_blank" rel="noopener noreferrer">Kubernetes Patch</a></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="modify-the-tidb-cluster-version">Modify the TiDB cluster version<a class="hash-link" href="#modify-the-tidb-cluster-version" title="Direct link to heading">​</a></h3><p>In this case, you can use a JSON merge patch to update the version of the TiDB cluster to &quot;nightly&quot;:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl patch tc basic -n tidb-cluster --type merge -p </span><span class="token string" style="color:#e3116c">&#x27;{&quot;spec&quot;: {&quot;version&quot;: &quot;nightly&quot;} }&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">tidbcluster.pingcap.com/basic patched</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><h3 class="anchor anchorWithStickyNavbar_mojV" id="wait-for-pods-to-restart">Wait for Pods to restart<a class="hash-link" href="#wait-for-pods-to-restart" title="Direct link to heading">​</a></h3><p>To follow the progress of the cluster as its components are upgraded, run the following command. You should see some Pods transiting to <code>Terminating</code> and then back to <code>ContainerCreating</code> and then to <code>Running</code>.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">watch kubectl get po -n tidb-cluster</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q"><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">NAME                              READY   STATUS        RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-discovery-6bb656bfd-7lbhx   1/1     Running       0          24m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-pd-0                        1/1     Terminating   0          5m31s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-tidb-0                      2/2     Running       0          2m19s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basic-tikv-0                      1/1     Running       0          4m13s</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><h3 class="anchor anchorWithStickyNavbar_mojV" id="forward-the-tidb-service-port">Forward the TiDB service port<a class="hash-link" href="#forward-the-tidb-service-port" title="Direct link to heading">​</a></h3><p>After all Pods have been restarted, you can see that the version number of the cluster has changed.</p><p>Note that you need to reset any port forwarding you set up in a previous step, because the pods they forwarded to have been destroyed and recreated.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl port-forward -n tidb-cluster svc/basic-tidb 24000:4000 &gt; pf24000.out &amp;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>If the port <code>24000</code> is already occupied, you can replace it with an available port.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="check-the-tidb-cluster-version">Check the TiDB cluster version<a class="hash-link" href="#check-the-tidb-cluster-version" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">mysql --comments -h 127.0.0.1 -P 24000 -u root -e &#x27;select tidb_version()\G&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary>Expected output</summary><div><div class="collapsibleContent_i85q"><p>Note that <code>nightly</code> is not a fixed version. Running the command above at a different time might return different results.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">*************************** 1. row ***************************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tidb_version(): Release Version: v5.4.0-alpha-445-g778e188fa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Edition: Community</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Git Commit Hash: 778e188fa7af4f48497ff9e05ca6681bf9a5fa16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Git Branch: master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UTC Build Time: 2021-12-17 17:02:49</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GoVersion: go1.16.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Race Enabled: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TiKV Min Version: v3.0.0-60965b006877ca7234adaced7890d7b029ed1306</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Check Table Before Drop: false</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div></details><h2 class="anchor anchorWithStickyNavbar_mojV" id="step-6-destroy-the-tidb-cluster-and-the-kubernetes-cluster">Step 6. Destroy the TiDB cluster and the Kubernetes cluster<a class="hash-link" href="#step-6-destroy-the-tidb-cluster-and-the-kubernetes-cluster" title="Direct link to heading">​</a></h2><p>After you finish testing, you can destroy the TiDB cluster and the Kubernetes cluster.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="destroy-the-tidb-cluster">Destroy the TiDB cluster<a class="hash-link" href="#destroy-the-tidb-cluster" title="Direct link to heading">​</a></h3><p>This section introduces how to destroy a TiDB cluster.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="stop-kubectl-port-forwarding">Stop <code>kubectl</code> port forwarding<a class="hash-link" href="#stop-kubectl-port-forwarding" title="Direct link to heading">​</a></h4><p>If you still have running <code>kubectl</code> processes that are forwarding ports, end them:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">pgrep -lfa kubectl</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="delete-the-tidb-cluster">Delete the TiDB cluster<a class="hash-link" href="#delete-the-tidb-cluster" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete tc basic -n tidb-cluster</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The <code>tc</code> in this command is a short name for tidbclusters.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="delete-tidb-monitoring-services">Delete TiDB monitoring services<a class="hash-link" href="#delete-tidb-monitoring-services" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete tidbmonitor basic -n tidb-cluster</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="delete-pv-data">Delete PV data<a class="hash-link" href="#delete-pv-data" title="Direct link to heading">​</a></h4><p>If your deployment has persistent data storage, deleting the TiDB cluster does not remove the data in the cluster. If you do not need the data, run the following commands to clean it:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete pvc -n tidb-cluster -l app.kubernetes.io/instance</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">basic,app.kubernetes.io/managed-by</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tidb-operator </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get </span><span class="token function" style="color:#d73a49">pv</span><span class="token plain"> -l app.kubernetes.io/namespace</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tidb-cluster,app.kubernetes.io/managed-by</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tidb-operator,app.kubernetes.io/instance</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">basic -o name </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">xargs</span><span class="token plain"> -I </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> kubectl patch </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> -p </span><span class="token string" style="color:#e3116c">&#x27;{&quot;spec&quot;:{&quot;persistentVolumeReclaimPolicy&quot;:&quot;Delete&quot;}}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="delete-namespaces">Delete namespaces<a class="hash-link" href="#delete-namespaces" title="Direct link to heading">​</a></h4><p>To ensure that there are no lingering resources, delete the namespace used for your TiDB cluster.</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete namespace tidb-cluster</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="destroy-the-kubernetes-cluster">Destroy the Kubernetes cluster<a class="hash-link" href="#destroy-the-kubernetes-cluster" title="Direct link to heading">​</a></h3><p>The method of destroying a Kubernetes cluster depends on how you create it. Here are the steps for destroying a Kubernetes cluster.</p><div><div label="kind"><p>To destroy a Kubernetes cluster created using kind, run the following command:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kind delete cluster</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div><div label="minikube"><p>To destroy a Kubernetes cluster created using minikube, run the following command:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">minikube delete</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="see-also">See also<a class="hash-link" href="#see-also" title="Direct link to heading">​</a></h2><p>If you want to deploy a TiDB cluster in production environments, refer to the following documents:</p><p>On public clouds:</p><ul><li><a href="/docusaurus-operator/deploy-on-aws-eks">Deploy TiDB on AWS EKS</a></li><li><a href="/docusaurus-operator/deploy-on-gcp-gke">Deploy TiDB on GCP GKE</a></li><li><a href="/docusaurus-operator/deploy-on-azure-aks">Deploy TiDB on Azure AKS</a></li><li><a href="/docusaurus-operator/deploy-on-alibaba-cloud">Deploy TiDB on Alibaba Cloud ACK</a></li></ul><p>In a self-managed Kubernetes cluster:</p><ul><li>Familiarize yourself with <a href="/docusaurus-operator/prerequisites">Prerequisites for TiDB in Kubernetes</a></li><li><a href="/docusaurus-operator/configure-storage-class#local-pv-configuration">Configure the local PV</a> for your Kubernetes cluster to achieve high performance for TiKV</li><li><a href="/docusaurus-operator/deploy-tidb-operator">Deploy TiDB Operator in Kubernetes</a></li><li><a href="/docusaurus-operator/deploy-on-general-kubernetes">Deploy TiDB in General Kubernetes</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/get-started.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docusaurus-operator/whats-new-in-v1.3"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">What&#x27;s New in TiDB Operator 1.3</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docusaurus-operator/prerequisites"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Prerequisites for TiDB in Kubernetes</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#step-1-create-a-test-kubernetes-cluster" class="table-of-contents__link toc-highlight">Step 1. Create a test Kubernetes cluster</a><ul><li><a href="#create-a-kubernetes-cluster-using-kind" class="table-of-contents__link toc-highlight">Create a Kubernetes cluster using kind</a></li><li><a href="#create-a-kubernetes-cluster-using-minikube" class="table-of-contents__link toc-highlight">Create a Kubernetes cluster using minikube</a></li></ul></li><li><a href="#step-2-deploy-tidb-operator" class="table-of-contents__link toc-highlight">Step 2. Deploy TiDB Operator</a><ul><li><a href="#install-tidb-operator-crds" class="table-of-contents__link toc-highlight">Install TiDB Operator CRDs</a></li><li><a href="#install-tidb-operator" class="table-of-contents__link toc-highlight">Install TiDB Operator</a></li></ul></li><li><a href="#step-3-deploy-a-tidb-cluster-and-its-monitoring-services" class="table-of-contents__link toc-highlight">Step 3. Deploy a TiDB cluster and its monitoring services</a><ul><li><a href="#deploy-a-tidb-cluster" class="table-of-contents__link toc-highlight">Deploy a TiDB cluster</a></li><li><a href="#deploy-tidb-monitoring-services" class="table-of-contents__link toc-highlight">Deploy TiDB monitoring services</a></li><li><a href="#view-the-pod-status" class="table-of-contents__link toc-highlight">View the Pod status</a></li></ul></li><li><a href="#step-4-connect-to-tidb" class="table-of-contents__link toc-highlight">Step 4. Connect to TiDB</a><ul><li><a href="#install-the-mysql-client" class="table-of-contents__link toc-highlight">Install the MySQL client</a></li><li><a href="#forward-port-4000" class="table-of-contents__link toc-highlight">Forward port 4000</a></li><li><a href="#connect-to-the-tidb-service" class="table-of-contents__link toc-highlight">Connect to the TiDB service</a></li><li><a href="#access-the-grafana-dashboard" class="table-of-contents__link toc-highlight">Access the Grafana dashboard</a></li></ul></li><li><a href="#step-5-upgrade-a-tidb-cluster" class="table-of-contents__link toc-highlight">Step 5. Upgrade a TiDB cluster</a><ul><li><a href="#modify-the-tidb-cluster-version" class="table-of-contents__link toc-highlight">Modify the TiDB cluster version</a></li><li><a href="#wait-for-pods-to-restart" class="table-of-contents__link toc-highlight">Wait for Pods to restart</a></li><li><a href="#forward-the-tidb-service-port" class="table-of-contents__link toc-highlight">Forward the TiDB service port</a></li><li><a href="#check-the-tidb-cluster-version" class="table-of-contents__link toc-highlight">Check the TiDB cluster version</a></li></ul></li><li><a href="#step-6-destroy-the-tidb-cluster-and-the-kubernetes-cluster" class="table-of-contents__link toc-highlight">Step 6. Destroy the TiDB cluster and the Kubernetes cluster</a><ul><li><a href="#destroy-the-tidb-cluster" class="table-of-contents__link toc-highlight">Destroy the TiDB cluster</a></li><li><a href="#destroy-the-kubernetes-cluster" class="table-of-contents__link toc-highlight">Destroy the Kubernetes cluster</a></li></ul></li><li><a href="#see-also" class="table-of-contents__link toc-highlight">See also</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docusaurus-operator/">User Manual</a></li><li class="footer__item"><a class="footer__link-item" href="/docusaurus-operator/architecture">Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/tidb" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://tidb.io" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>tidb.io<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/pingcap" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/pingcap/tidb-operator" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Source Code<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 TiDB in Kubernetes Docs, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docusaurus-operator/assets/js/runtime~main.b87ef9bf.js"></script>
<script src="/docusaurus-operator/assets/js/main.51dee141.js"></script>
</body>
</html>