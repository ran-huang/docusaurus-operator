"use strict";(self.webpackChunkpingcap_docs=self.webpackChunkpingcap_docs||[]).push([[2412],{3905:function(e,t,r){r.d(t,{Zo:function(){return p},kt:function(){return m}});var i=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r,i,n={},a=Object.keys(e);for(i=0;i<a.length;i++)r=a[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var s=i.createContext({}),u=function(e){var t=i.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},p=function(e){var t=u(e.components);return i.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var r=e.components,n=e.mdxType,a=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=u(r),m=n,f=d["".concat(s,".").concat(m)]||d[m]||c[m]||a;return r?i.createElement(f,o(o({ref:t},p),{},{components:r})):i.createElement(f,o({ref:t},p))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=r.length,o=new Array(a);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,o[1]=l;for(var u=2;u<a;u++)o[u]=r[u];return i.createElement.apply(null,o)}return i.createElement.apply(null,r)}d.displayName="MDXCreateElement"},6967:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return u},assets:function(){return p},toc:function(){return c},default:function(){return m}});var i=r(7462),n=r(3366),a=(r(7294),r(3905)),o=["components"],l={title:"What's New in TiDB Operator 1.3"},s="What's New in TiDB Operator 1.3",u={unversionedId:"whats-new-in-v1.3",id:"whats-new-in-v1.3",title:"What's New in TiDB Operator 1.3",description:"TiDB Operator 1.3 introduces the following key features, which helps you manage TiDB clusters and the tools more easily in terms of extensibility, usability, and security.",source:"@site/docs/whats-new-in-v1.3.md",sourceDirName:".",slug:"/whats-new-in-v1.3",permalink:"/docusaurus-operator/whats-new-in-v1.3",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/whats-new-in-v1.3.md",tags:[],version:"current",frontMatter:{title:"What's New in TiDB Operator 1.3"},sidebar:"mySidebar",previous:{title:"TiDB Operator Overview",permalink:"/docusaurus-operator/tidb-operator-overview"},next:{title:"Get Started With TiDB Operator in Kubernetes",permalink:"/docusaurus-operator/get-started"}},p={},c=[{value:"Compatibility changes",id:"compatibility-changes",level:2},{value:"Rolling upgrade changes",id:"rolling-upgrade-changes",level:2},{value:"Extensibility",id:"extensibility",level:2},{value:"Usability",id:"usability",level:2},{value:"Security",id:"security",level:2}],d={toc:c};function m(e){var t=e.components,r=(0,n.Z)(e,o);return(0,a.kt)("wrapper",(0,i.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"whats-new-in-tidb-operator-13"},"What's New in TiDB Operator 1.3"),(0,a.kt)("p",null,"TiDB Operator 1.3 introduces the following key features, which helps you manage TiDB clusters and the tools more easily in terms of extensibility, usability, and security."),(0,a.kt)("h2",{id:"compatibility-changes"},"Compatibility changes"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Enhance the feature of deploying a TiDB cluster across Kubernetes clusters. If you deploy a TiDB cluster across multiple Kubernetes clusters by TiDB Operator (<= v1.3.0-beta.1), upgrading TiDB Operator to v1.3.0 directly will change the image in use, cause the TiDB cluster to rolling update or even fail to run. If you need to upgrade TiDB Operator from earlier versions to v1.3.0, take the following steps:"),(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},"Update CRD."),(0,a.kt)("li",{parentName:"ol"},"Add a new ",(0,a.kt)("inlineCode",{parentName:"li"},"spec.acrossK8s")," field in the TidbCluster spec and set it to ",(0,a.kt)("inlineCode",{parentName:"li"},"true"),"."),(0,a.kt)("li",{parentName:"ol"},"Upgrade TiDB Operator."))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"The ",(0,a.kt)("inlineCode",{parentName:"p"},"ValidatingWebhook")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"MutatingWebhook")," of Pods are depricated. If you deploy Webhook in your TiDB cluster using TiDB Operator v1.2 or earlier versions, and enable ",(0,a.kt)("inlineCode",{parentName:"p"},"ValidatingWebhook")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"MutatingWebhook")," of Pods, upgrading TiDB Operator to v1.3.0-beta.1 or later versions will cause ",(0,a.kt)("inlineCode",{parentName:"p"},"ValidatingWebhook")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"MutatingWebhook")," to be deleted. But this has no impact on TiDB cluster management and does not affect the TiDB clusters in operation.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Generate v1 CRD to support deploying in Kubernetes v1.22 or later versions. If you deploy v1 CRD, TiDB Operator with v1.3.0-beta.1 or later versions will set the default ",(0,a.kt)("inlineCode",{parentName:"p"},"baseImage")," field of all components. If you use the field ",(0,a.kt)("inlineCode",{parentName:"p"},"image")," instead of the field ",(0,a.kt)("inlineCode",{parentName:"p"},"baseImage")," to set image, upgrading TiDB Operator to v1.3.0-beta.1 will cause TiDB Cluster to roll upgrade and even fail to run because using wrong image. You have to upgrade TiDB Operator by the following steps:"),(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},"Use fields ",(0,a.kt)("inlineCode",{parentName:"li"},"baseImage")," and ",(0,a.kt)("inlineCode",{parentName:"li"},"version")," to replace the field ",(0,a.kt)("inlineCode",{parentName:"li"},"image"),", refer to the document ",(0,a.kt)("a",{parentName:"li",href:"/docusaurus-operator/configure-a-tidb-cluster#version"},"Configure TiDB deployment"),"."),(0,a.kt)("li",{parentName:"ol"},"Upgrade TiDB Operator.")))),(0,a.kt)("h2",{id:"rolling-upgrade-changes"},"Rolling upgrade changes"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Optimize the default configuration of TiFlash (>= v5.4.0). Since v1.3.0-beta.1, TiDB Operator optimizes the default configuration for TiFlash >= v5.4.0. If you deploy a TiDB cluster >= v5.4 using TiDB Operator v1.2, after upgrading TiDB Operator to v1.3.x, the TiFlash component will be rolling updated. It is recommended to upgrade TiDB Operator to v1.3.x before upgrading the TiDB cluster to v5.4.x.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"TiKV under specific configurations might be rolling updated. If you deploy TiDB v5.0 or later versions, and configure ",(0,a.kt)("inlineCode",{parentName:"p"},"spec.tikv.seperateRocksDBLog: true")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"spec.tikv.separateRaftLog: true"),", upgrading TiDB Operator to v1.3.x will cause TiKV to be rolling updated.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"To support configuring Prometheus shards in the TidbMonitor CR, upgrading TiDB Operator to v1.3.x will cause the TidbMonitor Pod to be rolling updated."))),(0,a.kt)("h2",{id:"extensibility"},"Extensibility"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/docusaurus-operator/deploy-tidb-cluster-across-multiple-kubernetes"},"Deploying a TiDB cluster across multiple Kubernetes clusters")," becomes generally available. Now you can deploy ",(0,a.kt)("a",{parentName:"li",href:"/docusaurus-operator/deploy-heterogeneous-tidb-cluster"},"heterogeneous TiDB clusters")," across Kubernetes clusters."),(0,a.kt)("li",{parentName:"ul"},"Add a new ",(0,a.kt)("inlineCode",{parentName:"li"},"failover.recoverByUID")," field to support one-time recovery for TiKV, TiFlash, and DM Worker."),(0,a.kt)("li",{parentName:"ul"},"Support configuring ",(0,a.kt)("a",{parentName:"li",href:"https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/#pod-management-policies"},"PodManagementPolicy")," for the StatefulSets of TiDB cluster components."),(0,a.kt)("li",{parentName:"ul"},"Support configuring DNS config for Pods of all components."),(0,a.kt)("li",{parentName:"ul"},"Support Kubernetes >= v1.22.")),(0,a.kt)("h2",{id:"usability"},"Usability"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Support ",(0,a.kt)("a",{parentName:"li",href:"/docusaurus-operator/restart-a-tidb-cluster#perform-a-graceful-restart-to-a-single-tikv-pod"},"gracefully restarting a single TiKV Pod")," by configuring annotation."),(0,a.kt)("li",{parentName:"ul"},"Optimize the user experience of heterogeneous clusters. You can view monitoring metrics of a TiDB cluster and its heterogeneous cluster on the same Dashboard."),(0,a.kt)("li",{parentName:"ul"},"Support ",(0,a.kt)("a",{parentName:"li",href:"/docusaurus-operator/access-dashboard#enable-continuous-profiling"},"continuous profiling")," for TiDB clusters.")),(0,a.kt)("h2",{id:"security"},"Security"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Add a new ",(0,a.kt)("inlineCode",{parentName:"li"},"spec.tidb.tlsClient.skipInternalClientCA")," field to skip server certificate verification when internal components access TiDB."),(0,a.kt)("li",{parentName:"ul"},"Add a new ",(0,a.kt)("inlineCode",{parentName:"li"},"spec.tidb.initializer.createPassword")," field to support setting a random password for TiDB when deploying a new cluster."),(0,a.kt)("li",{parentName:"ul"},"Use ",(0,a.kt)("inlineCode",{parentName:"li"},"secretRef")," in TidbMonitor to obtain Grafana password to avoid plaintext password.")))}m.isMDXComponent=!0}}]);