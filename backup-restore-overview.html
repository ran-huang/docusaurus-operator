<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.16">
<title data-rh="true">Backup and Restore Overview | TiDB in Kubernetes Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ran-huang.github.io/docusaurus-operator/backup-restore-overview"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Backup and Restore Overview | TiDB in Kubernetes Docs"><meta data-rh="true" name="description" content="This document describes how to perform backup and restore on the TiDB cluster in Kubernetes. The backup and restore tools used are BR, Dumpling, and TiDB Lightning."><meta data-rh="true" property="og:description" content="This document describes how to perform backup and restore on the TiDB cluster in Kubernetes. The backup and restore tools used are BR, Dumpling, and TiDB Lightning."><link data-rh="true" rel="icon" href="/docusaurus-operator/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ran-huang.github.io/docusaurus-operator/backup-restore-overview"><link data-rh="true" rel="alternate" href="https://ran-huang.github.io/docusaurus-operator/backup-restore-overview" hreflang="en"><link data-rh="true" rel="alternate" href="https://ran-huang.github.io/docusaurus-operator/backup-restore-overview" hreflang="x-default"><link rel="stylesheet" href="/docusaurus-operator/assets/css/styles.68554639.css">
<link rel="preload" href="/docusaurus-operator/assets/js/runtime~main.f81f0faa.js" as="script">
<link rel="preload" href="/docusaurus-operator/assets/js/main.5a4d47d5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docusaurus-operator/"><div class="navbar__logo"><img src="/docusaurus-operator/img/tidb-logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/docusaurus-operator/img/tidb-logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">TiDB in Kubernetes</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docusaurus-operator/">Docs</a><a class="navbar__item navbar__link" href="/docusaurus-operator/architecture">Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ran-huang/docusaurus-operator" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">üåú</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">üåû</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode (currently light mode)"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docusaurus-operator/">TiDB in Kubernetes</a><button aria-label="Toggle the collapsible sidebar category &#x27;TiDB in Kubernetes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docusaurus-operator/get-started">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/docusaurus-operator/category/deploy">Deploy</a><button aria-label="Toggle the collapsible sidebar category &#x27;Deploy&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docusaurus-operator/restore-data-using-tidb-lightning">Migrate</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/docusaurus-operator/category/manage">Manage</a><button aria-label="Toggle the collapsible sidebar category &#x27;Manage&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docusaurus-operator/enable-tls-for-mysql-client">Secure</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus-operator/scale-a-tidb-cluster">Scale</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docusaurus-operator/upgrade-a-tidb-cluster">Upgrade</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docusaurus-operator/backup-restore-overview">Backup and Restore</a><button aria-label="Toggle the collapsible sidebar category &#x27;Backup and Restore&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus-operator/grant-permissions-to-remote-storage">Grant Permissions to Remote Storage</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docusaurus-operator/category/amazon-s3-compatible-storage">Amazon S3 Compatible Storage</a><button aria-label="Toggle the collapsible sidebar category &#x27;Amazon S3 Compatible Storage&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/docusaurus-operator/category/google-cloud-storage">Google Cloud Storage</a><button aria-label="Toggle the collapsible sidebar category &#x27;Google Cloud Storage&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docusaurus-operator/backup-to-pv-using-br">Persistent Volumes</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docusaurus-operator/restart-a-tidb-cluster">Maintain</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docusaurus-operator/monitor-a-tidb-cluster">Monitor and Alert</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docusaurus-operator/recover-deleted-cluster">Disaster Recovery</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docusaurus-operator/tips">Troubleshoot</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docusaurus-operator/faq">FAQ</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docusaurus-operator/category/manage">Manage</a></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docusaurus-operator/backup-restore-overview">Backup and Restore</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Backup and Restore Overview</h1><p>This document describes how to perform backup and restore on the TiDB cluster in Kubernetes. The backup and restore tools used are <a href="https://docs.pingcap.com/tidb/stable/backup-and-restore-tool" target="_blank" rel="noopener noreferrer">BR</a>, <a href="https://docs.pingcap.com/tidb/stable/dumpling-overview" target="_blank" rel="noopener noreferrer">Dumpling</a>, and <a href="https://docs.pingcap.com/tidb/stable/get-started-with-tidb-lightning" target="_blank" rel="noopener noreferrer">TiDB Lightning</a>.</p><p>TiDB Operator 1.1 and later versions implement the backup and restore methods using Custom Resource Definition (CRD):</p><div class="row"><article class="col col--6"><a class="card margin-bottom--lg padding--lg cardContainer_woeA cardContainerLink_iOSj" href="/docusaurus-operator/grant-permissions-to-remote-storage"><h2 class="text--truncate cardTitle_pNjP" title="Grant Permissions to Remote Storage">üìÑÔ∏è<!-- --> <!-- -->Grant Permissions to Remote Storage</h2><div class="text--truncate cardDescription_qC_k" title="This document describes how to grant permissions to access remote storage for backup and restore. During the backup process, TiDB cluster data is backed up to the remote storage. During the restore process, the backup data is restored from the remote storage to the TiDB cluster.">This document describes how to grant permissions to access remote storage for backup and restore. During the backup process, TiDB cluster data is backed up to the remote storage. During the restore process, the backup data is restored from the remote storage to the TiDB cluster.</div></a></article><article class="col col--6"><a class="card margin-bottom--lg padding--lg cardContainer_woeA cardContainerLink_iOSj" href="/docusaurus-operator/category/amazon-s3-compatible-storage"><h2 class="text--truncate cardTitle_pNjP" title="Amazon S3 Compatible Storage">üóÉÔ∏è<!-- --> <!-- -->Amazon S3 Compatible Storage</h2><div class="text--truncate cardDescription_qC_k" title="4 items">4 items</div></a></article><article class="col col--6"><a class="card margin-bottom--lg padding--lg cardContainer_woeA cardContainerLink_iOSj" href="/docusaurus-operator/category/google-cloud-storage"><h2 class="text--truncate cardTitle_pNjP" title="Google Cloud Storage">üóÉÔ∏è<!-- --> <!-- -->Google Cloud Storage</h2><div class="text--truncate cardDescription_qC_k" title="4 items">4 items</div></a></article><article class="col col--6"><a class="card margin-bottom--lg padding--lg cardContainer_woeA cardContainerLink_iOSj" href="/docusaurus-operator/backup-to-pv-using-br"><h2 class="text--truncate cardTitle_pNjP" title="Persistent Volumes">üóÉÔ∏è<!-- --> <!-- -->Persistent Volumes</h2><div class="text--truncate cardDescription_qC_k" title="2 items">2 items</div></a></article></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="user-scenarios">User scenarios<a class="hash-link" href="#user-scenarios" title="Direct link to heading">‚Äã</a></h2><p><a href="https://docs.pingcap.com/tidb/stable/dumpling-overview" target="_blank" rel="noopener noreferrer">Dumpling</a> is a data export tool that exports data stored in TiDB/MySQL as SQL or CSV data files to get the logic full backup or export. If you need to back up SST files (Key-Value pairs) directly or perform latency-insensitive incremental backup, refer to <a href="https://docs.pingcap.com/tidb/stable/backup-and-restore-tool" target="_blank" rel="noopener noreferrer">BR</a>. For real-time incremental backup, refer to <a href="https://docs.pingcap.com/tidb/stable/ticdc-overview" target="_blank" rel="noopener noreferrer">TiCDC</a>.</p><p><a href="https://docs.pingcap.com/tidb/stable/get-started-with-tidb-lightning" target="_blank" rel="noopener noreferrer">TiDB Lightning</a> is a tool used for fast full data import into a TiDB cluster. TiDB Lightning supports Dumpling or CSV format data source. You can use TiDB Lightning for the following two purposes:</p><ul><li>Quickly import large amounts of data</li><li>Restore all backup data</li></ul><p><a href="https://docs.pingcap.com/tidb/stable/backup-and-restore-tool" target="_blank" rel="noopener noreferrer">BR</a> is a command-line tool for distributed backup and restore of the TiDB cluster data. Compared with Dumpling and mydumper, BR is more suitable for scenarios of huge data volume. BR only supports TiDB v3.1 and later versions.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="backup-cr-fields">Backup CR fields<a class="hash-link" href="#backup-cr-fields" title="Direct link to heading">‚Äã</a></h2><p>To back up data for a TiDB cluster in Kubernetes, you can create a <code>Backup</code> Custom Resource (CR) object. For detailed backup process, refer to documents listed in <a href="#backup-and-restore-overview">Backup and Restore Overview</a>.</p><p>This section introduces the fields in the <code>Backup</code> CR.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="general-fields">General fields<a class="hash-link" href="#general-fields" title="Direct link to heading">‚Äã</a></h3><ul><li><p><code>.spec.metadata.namespace</code>: The namespace where the <code>Backup</code> CR is located.</p></li><li><p><code>.spec.toolImage</code>: The tool image used by <code>Backup</code>.</p><ul><li>When using BR for backup, you can specify the BR version in this field.<ul><li>If the field is not specified or the value is empty, the <code>pingcap/br:${tikv_version}</code> image is used for backup by default.</li><li>If the BR version is specified in this field, such as <code>.spec.toolImage: pingcap/br:v5.3.0</code>, the image of the specified version is used for backup.</li><li>If the BR version is not specified in the field, such as <code>.spec.toolImage: private/registry/br</code>, the <code>private/registry/br:${tikv_version}</code> image is used for backup.</li></ul></li><li>When using Dumpling for backup, you can specify the Dumpling version in this field. For example, <code>spec.toolImage: pingcap/dumpling:v5.3.0</code>. If not specified, the Dumpling version specified in <code>TOOLKIT_VERSION</code> of the <a href="https://github.com/pingcap/tidb-operator/blob/master/images/tidb-backup-manager/Dockerfile" target="_blank" rel="noopener noreferrer">Backup Manager Dockerfile</a> is used for backup by default.</li><li>TiDB Operator supports this configuration starting from v1.1.9.</li></ul></li><li><p><code>.spec.tikvGCLifeTime</code>: The temporary <code>tikv_gc_life_time</code> time setting during the backup, which defaults to 72h.</p><p>  Before the backup begins, if the <code>tikv_gc_life_time</code> setting in the TiDB cluster is smaller than <code>spec.tikvGCLifeTime</code> set by the user, TiDB Operator <a href="https://docs.pingcap.com/tidb/stable/dumpling-overview#tidb-gc-settings-when-exporting-a-large-volume-of-data" target="_blank" rel="noopener noreferrer">adjusts the value of <code>tikv_gc_life_time</code></a> to the value of <code>spec.tikvGCLifeTime</code>. This operation makes sure that the backup data is not garbage-collected by TiKV.</p><p>  After the backup, no matter the backup is successful or not, as long as the previous <code>tikv_gc_life_time</code> value is smaller than <code>.spec.tikvGCLifeTime</code>, TiDB Operator will try to set <code>tikv_gc_life_time</code> to the previous value.</p><p>  In extreme cases, if TiDB Operator fails to access the database, TiDB Operator cannot automatically recover the value of <code>tikv_gc_life_time</code> and treats the backup as failed. At this time, you can view <code>tikv_gc_life_time</code> of the current TiDB cluster using the following statement:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> VARIABLE_NAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> VARIABLE_VALUE </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tidb </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> VARIABLE_NAME </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tikv_gc_life_time&quot;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>  In the output of the command above, if the value of <code>tikv_gc_life_time</code> is still larger than expected (usually 10m), you need to <a href="https://docs.pingcap.com/tidb/stable/dumpling-overview#tidb-gc-settings-when-exporting-a-large-volume-of-data" target="_blank" rel="noopener noreferrer">set <code>tikv_gc_life_time</code> back</a> to the previous value manually:</p></li><li><p><code>.spec.cleanPolicy</code>: The cleaning policy for the backup data when the backup CR is deleted.</p><p>  Three clean policies are supported:</p><ul><li><p><code>Retain</code>: Under any circumstances, retain the backup data when deleting the backup CR.</p></li><li><p><code>Delete</code>: Under any circumstances, delete the backup data when deleting the backup CR.</p></li><li><p><code>OnFailure</code>: If the backup fails, delete the backup data when deleting the backup CR.</p><p>If this field is not configured, or if you configure a value other than the three policies above, the backup data is retained.</p><p>Note that in v1.1.2 and earlier versions, this field does not exist. The backup data is deleted along with the CR by default. For v1.1.3 or later versions, if you want to keep this earlier behavior, set this field to <code>Delete</code>.</p></li></ul></li><li><p><code>.spec.from.host</code>: The address of the TiDB cluster to be backed up, which is the service name of the TiDB cluster to be exported, such as <code>basic-tidb</code>.</p></li><li><p><code>.spec.from.port</code>: The port of the TiDB cluster to be backed up.</p></li><li><p><code>.spec.from.user</code>: The accessing user of the TiDB cluster to be backed up.</p></li><li><p><code>.spec.from.secretName</code>: The secret that contains the password of the <code>.spec.from.user</code>.</p></li><li><p><code>.spec.from.tlsClientSecretName</code>: The secret of the certificate used during the backup.</p><p>  If <a href="/docusaurus-operator/enable-tls-between-components">TLS</a> is enabled for the TiDB cluster, but you do not want to back up data using the <code>${cluster_name}-cluster-client-secret</code> as described in <a href="/docusaurus-operator/enable-tls-between-components">Enable TLS between TiDB Components</a>, you can use the <code>.spec.from.tlsClient.tlsSecret</code> parameter to specify a secret for the backup. To generate the secret, run the following command:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create secret generic </span><span class="token variable" style="color:#36acaa">${secret_name}</span><span class="token plain"> --namespace</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">${namespace}</span><span class="token plain"> --from-file</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tls.crt</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">${cert_path}</span><span class="token plain"> --from-file</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tls.key</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">${key_path}</span><span class="token plain"> --from-file</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ca.crt</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">${ca_path}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></li><li><p><code>.spec.storageClassName</code>: The persistent volume (PV) type specified for the backup operation.</p></li><li><p><code>.spec.storageSize</code>: The PV size specified for the backup operation (<code>100 Gi</code> by default). This value must be greater than the size of the TiDB cluster to be backed up.</p><p>  The PVC name corresponding to the <code>Backup</code> CR of a TiDB cluster is fixed. If the PVC already exists in the cluster namespace and the size is smaller than <code>spec.storageSize</code>, you need to delete this PVC and then run the Backup job.</p></li><li><p><code>.spec.tableFilter</code>: Specifies tables that match the <a href="https://docs.pingcap.com/tidb/stable/table-filter/" target="_blank" rel="noopener noreferrer">table filter rules</a> for BR or Dumpling. This field can be ignored by default.</p><p>  If the field is not configured, the default value of <code>tableFilter</code> is as follows:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">tableFilter:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- </span><span class="token string" style="color:#e3116c">&quot;*.*&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- </span><span class="token string" style="color:#e3116c">&quot;!/^(mysql|test|INFORMATION_SCHEMA|PERFORMANCE_SCHEMA|METRICS_SCHEMA|INSPECTION_SCHEMA)$/.*&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>  If you use BR to perform backup, BR backs up all schemas except the system schema.</p><blockquote><p><strong>Note:</strong></p><p>To use the table filter to exclude <code>db.table</code>, you need to first add the <code>*.*</code> rule to include all tables. For example:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">tableFilter:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;*.*&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;!db.table&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></blockquote></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="br-fields">BR fields<a class="hash-link" href="#br-fields" title="Direct link to heading">‚Äã</a></h3><ul><li><code>.spec.br.cluster</code>: The name of the cluster to be backed up.</li><li><code>.spec.br.clusterNamespace</code>: The <code>namespace</code> of the cluster to be backed up.</li><li><code>.spec.br.logLevel</code>: The log level (<code>info</code> by default).</li><li><code>.spec.br.statusAddr</code>: The listening address through which BR provides statistics. If not specified, BR does not listen on any status address by default.</li><li><code>.spec.br.concurrency</code>: The number of threads used by each TiKV process during backup. Defaults to <code>4</code> for backup and <code>128</code> for restore.</li><li><code>.spec.br.rateLimit</code>: The speed limit, in MB/s. If set to <code>4</code>, the speed limit is 4 MB/s. The speed limit is not set by default.</li><li><code>.spec.br.checksum</code>: Whether to verify the files after the backup is completed. Defaults to <code>true</code>.</li><li><code>.spec.br.timeAgo</code>: Backs up the data before <code>timeAgo</code>. If the parameter value is not specified (empty by default), it means backing up the current data. It supports data formats such as &quot;1.5h&quot; and &quot;2h45m&quot;. See <a href="https://golang.org/pkg/time/#ParseDuration" target="_blank" rel="noopener noreferrer">ParseDuration</a> for more information.</li><li><code>.spec.br.sendCredToTikv</code>: Whether the BR process passes its AWS or GCP privileges to the TiKV process. Defaults to <code>true</code>.</li><li><code>.spec.br.options</code>: The extra arguments that BR supports. This field is supported since TiDB Operator v1.1.6. It accepts an array of strings and can be used to specify the last backup timestamp <code>--lastbackupts</code> for incremental backup.</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="s3-storage-fields">S3 storage fields<a class="hash-link" href="#s3-storage-fields" title="Direct link to heading">‚Äã</a></h3><ul><li><p><code>.spec.s3.provider</code>: The supported S3-compatible storage provider. Options are as follows:</p><ul><li><code>alibaba</code>: Alibaba Cloud Object Storage System (OSS), formerly Aliyun</li><li><code>digitalocean</code>: Digital Ocean Spaces</li><li><code>dreamhost</code>: Dreamhost DreamObjects</li><li><code>ibmcos</code>: IBM COS S3</li><li><code>minio</code>: Minio Object Storage</li><li><code>netease</code>: Netease Object Storage (NOS)</li><li><code>wasabi</code>: Wasabi Object Storage</li><li><code>other</code>: Any other S3 compatible provider</li></ul></li><li><p><code>spec.s3.region</code>: If you want to use Amazon S3 for backup storage, configure this field as the region where Amazon S3 is located.</p></li><li><p><code>.spec.s3.bucket</code>: The name of the bucket compatible with S3 storage.</p></li><li><p><code>.spec.s3.prefix</code>: If you set this field, the value is used to make up the remote storage path <code>s3://${.spec.s3.bucket}/${.spec.s3.prefix}/backupName</code>.</p></li><li><p><code>.spec.s3.acl</code>: The supported access-control list (ACL) policies.</p><p>  Amazon S3 supports the following ACL options:</p><ul><li><p><code>private</code></p></li><li><p><code>public-read</code></p></li><li><p><code>public-read-write</code></p></li><li><p><code>authenticated-read</code></p></li><li><p><code>bucket-owner-read</code></p></li><li><p><code>bucket-owner-full-control</code></p><p>If the field is not configured, the policy defaults to <code>private</code>. For more information on the ACL policies, refer to <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html" target="_blank" rel="noopener noreferrer">AWS documentation</a>.</p></li></ul></li><li><p><code>.spec.s3.storageClass</code>: The supported storage class.</p><p>  Amazon S3 supports the following storage class options:</p><ul><li><p><code>STANDARD</code></p></li><li><p><code>REDUCED_REDUNDANCY</code></p></li><li><p><code>STANDARD_IA</code></p></li><li><p><code>ONEZONE_IA</code></p></li><li><p><code>GLACIER</code></p></li><li><p><code>DEEP_ARCHIVE</code></p><p>If the field is not configured, the storage class defaults to <code>STANDARD_IA</code>. For more information on storage classes, refer to <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/storage-class-intro.html" target="_blank" rel="noopener noreferrer">AWS documentation</a>.</p></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="gcs-fields">GCS fields<a class="hash-link" href="#gcs-fields" title="Direct link to heading">‚Äã</a></h3><ul><li><p><code>.spec.gcs.projectId</code>: The unique identifier of the user project on GCP. To obtain the project ID, refer to <a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects" target="_blank" rel="noopener noreferrer">GCP documentation</a>.</p></li><li><p><code>.spec.gcs.bucket</code>: The name of the bucket which stores data.</p></li><li><p><code>.spec.gcs.prefix</code>: If you set this field, the value is used to make up the path of the remote storage: <code>gcs://${.spec.gcs.bucket}/${.spec.gcs.prefix}/backupName</code>. This field can be ignored.</p></li><li><p><code>spec.gcs.storageClass</code>: The supported storage class.</p><p>  GCS supports the following storage class options:</p><ul><li><p><code>MULTI_REGIONAL</code></p></li><li><p><code>REGIONAL</code></p></li><li><p><code>NEARLINE</code></p></li><li><p><code>COLDLINE</code></p></li><li><p><code>DURABLE_REDUCED_AVAILABILITY</code></p><p>If the field is not configured, the storage class defaults to <code>COLDLINE</code>. For more information on storage classes, refer to <a href="https://cloud.google.com/storage/docs/storage-classes" target="_blank" rel="noopener noreferrer">GCS documentation</a>.</p></li></ul></li><li><p><code>.spec.gcs.objectAcl</code>: The supported object access-control list (ACL) policies.</p><p>  GCS supports the following object ACL options:</p><ul><li><p><code>authenticatedRead</code></p></li><li><p><code>bucketOwnerFullControl</code></p></li><li><p><code>bucketOwnerRead</code></p></li><li><p><code>private</code></p></li><li><p><code>projectPrivate</code></p></li><li><p><code>publicRead</code></p><p>If the field is not configured, the policy defaults to <code>private</code>. For more information on the ACL policies, refer to <a href="https://cloud.google.com/storage/docs/access-control/lists" target="_blank" rel="noopener noreferrer">GCS documentation</a>.</p></li></ul></li><li><p><code>.spec.gcs.bucketAcl</code>: The supported bucket access-control list (ACL) policies.</p><p>  GCS supports the following bucket ACL options:</p><ul><li><p><code>authenticatedRead</code></p></li><li><p><code>private</code></p></li><li><p><code>projectPrivate</code></p></li><li><p><code>publicRead</code></p></li><li><p><code>publicReadWrite</code></p><p>If the field is not configured, the policy defaults to <code>private</code>. For more information on the ACL policies, refer to <a href="https://cloud.google.com/storage/docs/access-control/lists" target="_blank" rel="noopener noreferrer">GCS documentation</a>.</p></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="local-storage-fields">Local storage fields<a class="hash-link" href="#local-storage-fields" title="Direct link to heading">‚Äã</a></h3><ul><li><code>.spec.local.prefix</code>: The storage directory of the persistent volumes. If you set this field, the value is used to make up the storage path of the persistent volume: <code>local://${.spec.local.volumeMount.mountPath}/${.spec.local.prefix}/</code>.</li><li><code>.spec.local.volume</code>: The persistent volume configuration.</li><li><code>.spec.local.volumeMount</code>: The persistent volume mount configuration.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="restore-cr-fields">Restore CR fields<a class="hash-link" href="#restore-cr-fields" title="Direct link to heading">‚Äã</a></h2><p>To restore data to a TiDB cluster in Kubernetes, you can create a <code>Restore</code> CR object. For detailed restore process, refer to documents listed in <a href="#backup-and-restore-overview">Backup and Restore Overview</a>.</p><p>This section introduces the fields in the <code>Restore</code> CR.</p><ul><li><p><code>.spec.metadata.namespace</code>: The namespace where the <code>Restore</code> CR is located.</p></li><li><p><code>.spec.toolImage</code>ÔºöThe tools image used by <code>Restore</code>.</p><ul><li>When using BR for restoring, you can specify the BR version in this field. For example,<code>spec.toolImage: pingcap/br:v5.3.0</code>. If not specified, <code>pingcap/br:${tikv_version}</code> is used for restoring by default.</li><li>When using Lightning for restoring, you can specify the Lightning version in this field. For example, <code>spec.toolImage: pingcap/lightning:v5.3.0</code>. If not specified, the Lightning version specified in <code>TOOLKIT_VERSION</code> of the <a href="https://github.com/pingcap/tidb-operator/blob/master/images/tidb-backup-manager/Dockerfile" target="_blank" rel="noopener noreferrer">Backup Manager Dockerfile</a> is used for restoring by default.</li><li>TiDB Operator supports this configuration starting from v1.1.9.</li></ul></li><li><p><code>.spec.to.host</code>: The address of the TiDB cluster to be restored.</p></li><li><p><code>.spec.to.port</code>: The port of the TiDB cluster to be restored.</p></li><li><p><code>.spec.to.user</code>: The accessing user of the TiDB cluster to be restored.</p></li><li><p><code>.spec.to.secretName</code>: The secret that contains the password of the <code>.spec.to.user</code>.</p></li><li><p><code>.spec.to.tlsClientSecretName</code>: The secret of the certificate used during the restore.</p><p>  If <a href="/docusaurus-operator/enable-tls-between-components">TLS</a> is enabled for the TiDB cluster, but you do not want to restore data using the <code>${cluster_name}-cluster-client-secret</code> as described in <a href="/docusaurus-operator/enable-tls-between-components">Enable TLS between TiDB Components</a>, you can use the <code>.spec.to.tlsClient.tlsSecret</code> parameter to specify a secret for the restore. To generate the secret, run the following command:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create secret generic </span><span class="token variable" style="color:#36acaa">${secret_name}</span><span class="token plain"> --namespace</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">${namespace}</span><span class="token plain"> --from-file</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tls.crt</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">${cert_path}</span><span class="token plain"> --from-file</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tls.key</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">${key_path}</span><span class="token plain"> --from-file</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ca.crt</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">${ca_path}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></li><li><p><code>.spec.storageClassName</code>: The persistent volume (PV) type specified for the restore operation.</p></li><li><p><code>.spec.storageSize</code>: The PV size specified for the restore operation. This value must be greater than the size of the backup data.</p></li><li><p><code>.spec.tableFilter</code>: Specifies tables that match the <a href="https://docs.pingcap.com/tidb/stable/table-filter/" target="_blank" rel="noopener noreferrer">table filter rules</a> for BR. This field can be ignored by default.</p><p>  If the field is not configured, the default <code>tableFilter</code> value for TiDB Lightning is as follows:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">tableFilter:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- </span><span class="token string" style="color:#e3116c">&quot;*.*&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- </span><span class="token string" style="color:#e3116c">&quot;!/^(mysql|test|INFORMATION_SCHEMA|PERFORMANCE_SCHEMA|METRICS_SCHEMA|INSPECTION_SCHEMA)$/.*&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>  If this field is not configured, BR restores all the schemas in the backup file.</p><blockquote><p><strong>Note:</strong></p><p>To use the table filter to exclude <code>db.table</code>, you need to first add the <code>*.*</code> rule to include all tables. For example:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">tableFilter:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;*.*&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- &quot;!db.table&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></blockquote></li><li><p><code>.spec.br</code>: BR-related configuration. Refer to <a href="#br-fields">BR fields</a>.</p></li><li><p><code>.spec.s3</code>: S3-related configuration. Refer to <a href="#s3-storage-fields">S3 storage fields</a>.</p></li><li><p><code>.spec.gcs</code>: GCS-related configuration. Refer to <a href="#gcs-fields">GCS fields</a>.</p></li><li><p><code>.spec.local</code>: Persistent volume-related configuration. Refer to <a href="#local-storage-fields">Local storage fields</a>.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="backupschedule-cr-fields">BackupSchedule CR fields<a class="hash-link" href="#backupschedule-cr-fields" title="Direct link to heading">‚Äã</a></h2><p>The <code>backupSchedule</code> configuration consists of two parts. One is the unique configuration of <code>backupSchedule</code>, and the other is <code>backupTemplate</code>. <code>backupTemplate</code> specifies the configuration related to the cluster and remote storage, which is the same as the <code>spec</code> configuration of <a href="#backup-cr-fields">the <code>Backup</code> CR</a>.</p><p>The unique configuration items of <code>backupSchedule</code> are as follows:</p><ul><li><code>.spec.maxBackups</code>: A backup retention policy, which determines the maximum number of backup files to be retained. When the number of backup files exceeds this value, the outdated backup file will be deleted. If you set this field to <code>0</code>, all backup items are retained.</li><li><code>.spec.maxReservedTime</code>: A backup retention policy based on time. For example, if you set the value of this field to <code>24h</code>, only backup files within the recent 24 hours are retained. All backup files older than this value are deleted. For the time format, refer to <a href="https://golang.org/pkg/time/#ParseDuration" target="_blank" rel="noopener noreferrer"><code>func ParseDuration</code></a>. If you have set <code>.spec.maxBackups</code> and <code>.spec.maxReservedTime</code> at the same time, the latter takes effect.</li><li><code>.spec.schedule</code>: The time scheduling format of Cron. Refer to <a href="https://en.wikipedia.org/wiki/Cron" target="_blank" rel="noopener noreferrer">Cron</a> for details.</li><li><code>.spec.pause</code>: <code>false</code> by default. If this field is set to <code>true</code>, the scheduled scheduling is paused. In this situation, the backup operation will not be performed even if the scheduling time is reached. During this pause, the backup Garbage Collection runs normally. If you change <code>true</code> to <code>false</code>, the scheduled full backup process is restarted.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="delete-the-backup-cr">Delete the Backup CR<a class="hash-link" href="#delete-the-backup-cr" title="Direct link to heading">‚Äã</a></h2><p>You can delete the <code>Backup</code> CR or <code>BackupSchedule</code> CR by running the following commands:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete backup </span><span class="token variable" style="color:#36acaa">${name}</span><span class="token plain"> -n </span><span class="token variable" style="color:#36acaa">${namespace}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete backupschedule </span><span class="token variable" style="color:#36acaa">${name}</span><span class="token plain"> -n </span><span class="token variable" style="color:#36acaa">${namespace}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>If you use TiDB Operator v1.1.2 or an earlier version, or if you use TiDB Operator v1.1.3 or a later version and set the value of <code>spec.cleanPolicy</code> to <code>Delete</code>, TiDB Operator cleans the backup data when it deletes the CR.</p><p>In such cases, if you need to delete the namespace, it is recommended that you first delete all the <code>Backup</code>/<code>BackupSchedule</code> CRs and then delete the namespace.</p><p>If you delete the namespace before you delete the <code>Backup</code>/<code>BackupSchedule</code> CR, TiDB Operator will keep creating jobs to clean the backup data. However, because the namespace is in <code>Terminating</code> state, TiDB Operator fails to create such a job, which causes the namespace to be stuck in this state.</p><p>To address this issue, delete <code>finalizers</code> by running the following command:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl patch -n </span><span class="token variable" style="color:#36acaa">${namespace}</span><span class="token plain"> backup </span><span class="token variable" style="color:#36acaa">${name}</span><span class="token plain"> --type merge -p </span><span class="token string" style="color:#e3116c">&#x27;{&quot;metadata&quot;:{&quot;finalizers&quot;:[]}}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="clean-backup-data">Clean backup data<a class="hash-link" href="#clean-backup-data" title="Direct link to heading">‚Äã</a></h3><p>For TiDB Operator v1.2.3 and earlier versions, TiDB Operator cleans the backup data by deleting the backup files one by one.</p><p>For TiDB Operator v1.2.4 and later versions, TiDB Operator cleans the backup data by deleting the backup files in batches. For the batch deletion, the deletion methods are different depending on the type of backend storage used for backups.</p><ul><li>For the S3-compatible backend storage, TiDB Operator uses the concurrent batch deletion method, which deletes files in batch concurrently. TiDB Operator starts multiple goroutines concurrently, and each goroutine uses the batch delete API <a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteObjects.html" target="_blank" rel="noopener noreferrer">&quot;DeleteObjects&quot;</a> to delete multiple files.</li><li>For other types of backend storage, TiDB Operator uses the concurrent deletion method, which deletes files concurrently. TiDB Operator starts multiple goroutines, and each goroutine deletes one file at a time.</li></ul><p>For TiDB Operator v1.2.4 and later versions, you can configure the following fields in the Backup CR to control the clean behavior:</p><ul><li><p><code>.spec.cleanOption.pageSize</code>: Specifies the number of files to be deleted in each batch at a time. The default value is 10000.</p></li><li><p><code>.spec.cleanOption.disableBatchConcurrency</code>: If the value of this field is <code>true</code>, TiDB Operator disables the concurrent batch deletion method and uses the concurrent deletion method.</p><p>  If your S3-compatible backend storage does not support the <code>DeleteObjects</code> API, the default concurrent batch deletion method fails. You need to configure this field to <code>true</code> to use the concurrent deletion method.</p></li><li><p><code>.spec.cleanOption.batchConcurrency</code>: Specifies the number of goroutines to start for the concurrent batch deletion method. The default value is <code>10</code>.</p></li><li><p><code>.spec.cleanOption.routineConcurrency</code>: Specifies the number of goroutines to start  for the concurrent deletion method. The default value is <code>100</code>.</p></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/backup-restore-overview.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docusaurus-operator/canary-upgrade-tidb-operator"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Perform a Canary Upgrade on TiDB Operator</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docusaurus-operator/grant-permissions-to-remote-storage"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Grant Permissions to Remote Storage</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#user-scenarios" class="table-of-contents__link toc-highlight">User scenarios</a></li><li><a href="#backup-cr-fields" class="table-of-contents__link toc-highlight">Backup CR fields</a><ul><li><a href="#general-fields" class="table-of-contents__link toc-highlight">General fields</a></li><li><a href="#br-fields" class="table-of-contents__link toc-highlight">BR fields</a></li><li><a href="#s3-storage-fields" class="table-of-contents__link toc-highlight">S3 storage fields</a></li><li><a href="#gcs-fields" class="table-of-contents__link toc-highlight">GCS fields</a></li><li><a href="#local-storage-fields" class="table-of-contents__link toc-highlight">Local storage fields</a></li></ul></li><li><a href="#restore-cr-fields" class="table-of-contents__link toc-highlight">Restore CR fields</a></li><li><a href="#backupschedule-cr-fields" class="table-of-contents__link toc-highlight">BackupSchedule CR fields</a></li><li><a href="#delete-the-backup-cr" class="table-of-contents__link toc-highlight">Delete the Backup CR</a><ul><li><a href="#clean-backup-data" class="table-of-contents__link toc-highlight">Clean backup data</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docusaurus-operator/">User Manual</a></li><li class="footer__item"><a class="footer__link-item" href="/docusaurus-operator/architecture">Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/tidb" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://tidb.io" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>tidb.io<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/pingcap" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/pingcap/tidb-operator" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Source Code<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 TiDB in Kubernetes Docs, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docusaurus-operator/assets/js/runtime~main.f81f0faa.js"></script>
<script src="/docusaurus-operator/assets/js/main.5a4d47d5.js"></script>
</body>
</html>