<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.16">
<title data-rh="true">Configuration of tidb-cluster Chart | TiDB in Kubernetes Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ran-huang.github.io/tidb-cluster-chart-config"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Configuration of tidb-cluster Chart | TiDB in Kubernetes Docs"><meta data-rh="true" name="description" content="This document describes the configuration of the tidb-cluster chart."><meta data-rh="true" property="og:description" content="This document describes the configuration of the tidb-cluster chart."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ran-huang.github.io/tidb-cluster-chart-config"><link data-rh="true" rel="alternate" href="https://ran-huang.github.io/tidb-cluster-chart-config" hreflang="en"><link data-rh="true" rel="alternate" href="https://ran-huang.github.io/tidb-cluster-chart-config" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.732b35c1.css">
<link rel="preload" href="/assets/js/runtime~main.c82b2755.js" as="script">
<link rel="preload" href="/assets/js/main.1f32aa1c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/tidb-logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/tidb-logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">TiDB in Kubernetes</b></a><a class="navbar__item navbar__link" href="/">Docs</a><a class="navbar__item navbar__link navbar__link--active" href="/architecture">Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ran-huang/docs-tidb-operator" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode (currently light mode)"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/architecture">Architecture</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/benchmark-sysbench">TiDB in Kubernetes Sysbench Performance Test</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://github.com/pingcap/tidb-operator/blob/master/docs/api-references/docs.md" target="_blank" rel="noopener noreferrer" class="menu__link"><span>API References<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cheat-sheet">Command Cheat Sheet for TiDB Cluster Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tidb-operator-rbac">RBAC rules required by TiDB Operator</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/use-tkctl">Tools</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/configure-tidb-binlog-drainer">Configure</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/configure-tidb-binlog-drainer">TiDB Binlog Drainer Configurations in Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/tidb-cluster-chart-config">Configuration of tidb-cluster Chart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/configure-backup">Configuration of tidb-backup Chart</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/logs-collection">TiDB Log Collection in Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/monitor-kubernetes">Monitoring and Alerts on Kubernetes</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">Configure</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/tidb-cluster-chart-config">Configuration of tidb-cluster Chart</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Configuration of tidb-cluster Chart</h1><p>This document describes the configuration of the tidb-cluster chart.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>For TiDB Operator v1.1 and later versions, it is recommended not to use the tidb-cluster chart to deploy and manage the TiDB cluster. For details, refer to <a href="/notes-tidb-operator-v1.1">TiDB Operator v1.1 Notes</a>.</p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="parameters">Parameters<a class="hash-link" href="#parameters" title="Direct link to heading">â€‹</a></h2><table><thead><tr><th align="left">Parameter</th><th align="left">Description</th><th align="left">Default value</th></tr></thead><tbody><tr><td align="left"><code>rbac.create</code></td><td align="left">Whether to enable RBAC for Kubernetes</td><td align="left"><code>true</code></td></tr><tr><td align="left"><code>clusterName</code></td><td align="left">TiDB cluster name. This variable is not set by default, and <code>tidb-cluster</code> directly uses <code>ReleaseName</code> during installation instead of the TiDB cluster name.</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>extraLabels</code></td><td align="left">Add extra labels to the <code>TidbCluster</code> object (CRD). Refer to <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/" target="_blank" rel="noopener noreferrer">labels</a></td><td align="left"><code>{}</code></td></tr><tr><td align="left"><code>schedulerName</code></td><td align="left">Scheduler used by TiDB cluster</td><td align="left"><code>tidb-scheduler</code></td></tr><tr><td align="left"><code>timezone</code></td><td align="left">The default time zone of the TiDB cluster</td><td align="left"><code>UTC</code></td></tr><tr><td align="left"><code>pvReclaimPolicy</code></td><td align="left">Reclaim policy for PVs (Persistent Volumes) used by the TiDB cluster</td><td align="left"><code>Retain</code></td></tr><tr><td align="left"><code>services[0].name</code></td><td align="left">Name of the service exposed by the TiDB cluster</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>services[0].type</code></td><td align="left">Type of the service exposed by the TiDB cluster (selected from <code>ClusterIP</code>, <code>NodePort</code>, <code>LoadBalancer</code>)</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>discovery.image</code></td><td align="left">Mirror image of the PD service discovery component in the TiDB cluster, which is used to provide service discovery for each PD instance to coordinate the startup sequence when the PD cluster is first started</td><td align="left"><code>pingcap/tidb-operator:v1.0.0-beta.3</code></td></tr><tr><td align="left"><code>discovery.imagePullPolicy</code></td><td align="left">Pull strategy for the PD service discovery component image</td><td align="left"><code>IfNotPresent</code></td></tr><tr><td align="left"><code>discovery.resources.limits.cpu</code></td><td align="left">CPU resource limit for PD service discovery component</td><td align="left"><code>250m</code></td></tr><tr><td align="left"><code>discovery.resources.limits.memory</code></td><td align="left">Memory resource limit for PD service discovery component</td><td align="left"><code>150Mi</code></td></tr><tr><td align="left"><code>discovery.resources.requests.cpu</code></td><td align="left">CPU resource request for PD service discovery component</td><td align="left"><code>80m</code></td></tr><tr><td align="left"><code>discovery.resources.requests.memory</code></td><td align="left">Memory resource request for PD service discovery component</td><td align="left"><code>50Mi</code></td></tr><tr><td align="left"><code>enableConfigMapRollout</code></td><td align="left">Whether to enable automatic rolling update for the TiDB cluster. If enabled, the TiDB cluster automatically updates the corresponding components when the ConfigMap of the TiDB cluster changes. This configuration is only supported in TiDB Operator v1.0 and later versions</td><td align="left"><code>false</code></td></tr><tr><td align="left"><code>pd.config</code></td><td align="left">Configuration of PD in configuration file format. To view the default PD configuration file, refer to <a href="https://github.com/pingcap/pd/blob/master/conf/config.toml" target="_blank" rel="noopener noreferrer"><code>pd/conf/config.toml</code></a> and select the tag of the corresponding PD version. To view the descriptions of parameters, refer to <a href="https://pingcap.com/docs/stable/reference/configuration/pd-server/configuration-file" target="_blank" rel="noopener noreferrer">PD configuration description</a> and select the corresponding document version. Here you only need to modify the configuration according to the format in the configuration file.</td><td align="left">If the TiDB Operator version &lt;= v1.0.0-beta.3, the default value is <br><code>nil</code><br> If the TiDB Operator version &gt; v1.0.0-beta.3, the default value is <br><code>[log]</code><br><code>level = &quot;info&quot;</code><br><code>[replication]</code><br><code>location-labels = [&quot;region&quot;, &quot;zone&quot;, &quot;rack&quot;, &quot;host&quot;]</code><br> For example, <br>Â <!-- -->Â <code>config:</code> <!-- -->|<br>Â <!-- -->Â <!-- -->Â <!-- -->Â <code>[log]</code><br>Â <!-- -->Â <!-- -->Â <!-- -->Â <code>level = &quot;info&quot;</code><br>Â <!-- -->Â <!-- -->Â <!-- -->Â <code>[replication]</code><br>Â <!-- -->Â <!-- -->Â <!-- -->Â <code>location-labels = [&quot;region&quot;, &quot;zone&quot;, &quot;rack&quot;, &quot;host&quot;]</code></td></tr><tr><td align="left"><code>pd.replicas</code></td><td align="left">Number of Pods in PD</td><td align="left"><code>3</code></td></tr><tr><td align="left"><code>pd.image</code></td><td align="left">PD image</td><td align="left"><code>pingcap/pd:v3.0.0-rc.1</code></td></tr><tr><td align="left"><code>pd.imagePullPolicy</code></td><td align="left">Pull strategy for PD mirror</td><td align="left"><code>IfNotPresent</code></td></tr><tr><td align="left"><code>pd.logLevel</code></td><td align="left">If TiDB Operator version&gt; v1.0.0-beta.3, configure in <code>pd.config</code>: <br><code>[log]</code><br><code>level = &quot;info&quot;</code></td><td align="left"><code>info</code></td></tr><tr><td align="left"><code>pd.storageClassName</code></td><td align="left"><code>storageClass</code> used by PD. <code>storageClassName</code> refers to a type of storage provided by the Kubernetes cluster. Different classes may be mapped to service quality levels, backup policies, or any policies determined by the cluster administrator. For details, refer to <a href="https://kubernetes.io/docs/concepts/storage/storage-classes" target="_blank" rel="noopener noreferrer">storage-classes</a></td><td align="left"><code>local-storage</code></td></tr><tr><td align="left"><code>pd.maxStoreDownTime</code></td><td align="left"><code>pd.maxStoreDownTime</code> refers to the time that a store node is disconnected before the node is marked as <code>down</code>. When the status becomes <code>down</code>, the store node starts to migrate its data to other store nodes.<br>If TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>pd.config</code>:<br><code>[schedule]</code><br><code>max-store-down-time = &quot;30m&quot;</code></td><td align="left"><code>30m</code></td></tr><tr><td align="left"><code>pd.maxReplicas</code></td><td align="left"><code>pd.maxReplicas</code> is the number of replicas in the TiDB cluster.<br>If TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>pd.config</code>:<br><code>[replication]</code><br><code>max-replicas = 3</code></td><td align="left"><code>3</code></td></tr><tr><td align="left"><code>pd.resources.limits.cpu</code></td><td align="left">CPU resource limit for each PD Pod</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>pd.resources.limits.memory</code></td><td align="left">Memory resource limit for each PD Pod</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>pd.resources.limits.storage</code></td><td align="left">Storage capacity limit for each PD Pod</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>pd.resources.requests.cpu</code></td><td align="left">CPU resource request for each PD Pod</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>pd.resources.requests.memory</code></td><td align="left">Memory resource request for each PD Pod</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>pd.resources.requests.storage</code></td><td align="left">Storage capacity request for each PD Pod</td><td align="left"><code>1Gi</code></td></tr><tr><td align="left"><code>pd.affinity</code></td><td align="left"><code>pd.affinity</code> defines PD scheduling rules and preferences. For details, refer to <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#affinity-and-anti-affinity" target="_blank" rel="noopener noreferrer">affinity-and-anti-affinity</a></td><td align="left"><code>{}</code></td></tr><tr><td align="left"><code>pd.nodeSelector</code></td><td align="left"><code>pd.nodeSelector</code> makes sure that PD Pods are dispatched only to nodes that have this key-value pair as a label. For details, refer to <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector" target="_blank" rel="noopener noreferrer">nodeselector</a></td><td align="left"><code>{}</code></td></tr><tr><td align="left"><code>pd.tolerations</code></td><td align="left"><code>pd.tolerations</code> applies to PD Pods, allowing PD Pods to be dispatched to nodes with specified taints. For details, refer to <a href="https://kubernetes.io/docs/concepts/configuration/taint-and-toleration" target="_blank" rel="noopener noreferrer">taint-and-toleration</a></td><td align="left"><code>{}</code></td></tr><tr><td align="left"><code>pd.annotations</code></td><td align="left">Add specific <code>annotations</code> to PD Pods</td><td align="left"><code>{}</code></td></tr><tr><td align="left"><code>tikv.config</code></td><td align="left">Configuration of TiKV in configuration file format. To view the default TiKV configuration file, refer to <a href="https://github.com/tikv/tikv/blob/master/etc/config-template.toml" target="_blank" rel="noopener noreferrer"><code>tikv/etc/config-template.toml</code></a> and select the tag of the corresponding TiKV version. To view the descriptions of parameters, refer to <a href="https://pingcap.com/docs/stable/reference/configuration/tikv-server/configuration-file/" target="_blank" rel="noopener noreferrer">TiKV configuration description</a> and select the corresponding document version. Here you only need to modify the configuration according to the format in the configuration file.<br><br>The following two configuration items need to be configured explicitly:<br><br><code>[storage.block-cache]</code><br>Â <!-- -->Â <code>shared = true</code><br>Â <!-- -->Â <code>capacity = &quot;1GB&quot;</code><br>Recommended: set <code>capacity</code> to 50% of <code>tikv.resources.limits.memory</code><br><br><code>[readpool.coprocessor]</code><br>Â <!-- -->Â <code>high-concurrency = 8</code><br>Â <!-- -->Â <code>normal-concurrency = 8</code><br>Â <!-- -->Â <code>low-concurrency = 8</code><br>Recommended: set to 80% of <code>tikv.resources.limits.cpu</code></td><td align="left">If the TiDB Operator version &lt;= v1.0.0-beta.3, the default value is<br><code>nil</code><br>If the TiDB Operator version &gt; v1.0.0-beta.3, the default value is<br><code>log-level = &quot;info&quot;</code><br>For example:<br>Â <!-- -->Â <code>config:</code> <!-- -->|<br>Â <!-- -->Â <!-- -->Â <!-- -->Â <code>log-level = &quot;info&quot;</code></td></tr><tr><td align="left"><code>tikv.replicas</code></td><td align="left">Number of Pods in TiKV</td><td align="left"><code>3</code></td></tr><tr><td align="left"><code>tikv.image</code></td><td align="left">Image of TiKV</td><td align="left"><code>pingcap/tikv:v3.0.0-rc.1</code></td></tr><tr><td align="left"><code>tikv.imagePullPolicy</code></td><td align="left">Pull strategy for TiKV image</td><td align="left"><code>IfNotPresent</code></td></tr><tr><td align="left"><code>tikv.logLevel</code></td><td align="left">TiKV log level.<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tikv.config</code>:<br><code>log-level = &quot;info&quot;</code></td><td align="left"><code>info</code></td></tr><tr><td align="left"><code>tikv.storageClassName</code></td><td align="left"><code>storageClass</code> used by TiKV. <code>storageClassName</code> refers to a type of storage provided by the Kubernetes cluster. Different classes may be mapped to service quality levels, backup policies, or any policies determined by the cluster administrator. For details, refer to <a href="https://kubernetes.io/docs/concepts/storage/storage-classes" target="_blank" rel="noopener noreferrer">storage-classes</a></td><td align="left"><code>local-storage</code></td></tr><tr><td align="left"><code>tikv.syncLog</code></td><td align="left"><code>syncLog</code> indicates whether to enable the raft log replication feature. If enabled, the feature ensure that data is not lost during poweroff.<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tikv.config</code>:<br><code>[raftstore]</code><br><code>sync-log = true</code></td><td align="left"><code>true</code></td></tr><tr><td align="left"><code>tikv.grpcConcurrency</code></td><td align="left">Configure the size of the gRPC server thread pool.<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tikv.config</code>:<br><code>[server]</code><br><code>grpc-concurrency = 4</code></td><td align="left"><code>4</code></td></tr><tr><td align="left"><code>tikv.resources.limits.cpu</code></td><td align="left">CPU resource limit for each TiKV Pod</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>tikv.resources.limits.memory</code></td><td align="left">Memory resource limit for each TiKV Pod</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>tikv.resources.limits.storage</code></td><td align="left">Storage capacity limit for each TiKV Pod</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>tikv.resources.requests.cpu</code></td><td align="left">CPU resource request for each TiKV Pod</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>tikv.resources.requests.memory</code></td><td align="left">Memory resource request for each TiKV Pod</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>tikv.resources.requests.storage</code></td><td align="left">Storage capacity request for each TiKV Pod</td><td align="left"><code>10Gi</code></td></tr><tr><td align="left"><code>tikv.affinity</code></td><td align="left"><code>tikv.affinity</code> defines TiKV&#x27;s scheduling rules and preferences. For details, refer to <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#affinity-and-anti-affinity" target="_blank" rel="noopener noreferrer">affinity-and-anti-affinity</a></td><td align="left"><code>{}</code></td></tr><tr><td align="left"><code>tikv.nodeSelector</code></td><td align="left"><code>tikv.nodeSelector</code> makes sure that TiKV Pods are dispatched only to nodes that have this key-value pair as a label. For details, refer to <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector" target="_blank" rel="noopener noreferrer">nodeselector</a></td><td align="left"><code>{}</code></td></tr><tr><td align="left"><code>tikv.tolerations</code></td><td align="left"><code>tikv.tolerations</code> applies to TiKV Pods, allowing TiKV Pods to be dispatched to nodes with specified taints. For details, refer to <a href="https://kubernetes.io/docs/concepts/configuration/taint-and-toleration" target="_blank" rel="noopener noreferrer">taint-and-toleration</a></td><td align="left"><code>{}</code></td></tr><tr><td align="left"><code>tikv.annotations</code></td><td align="left">Add specific <code>annotations</code> for TiKV Pods</td><td align="left"><code>{}</code></td></tr><tr><td align="left"><code>tikv.defaultcfBlockCacheSize</code></td><td align="left">Specifies the block cache size. The block cache is used to cache uncompressed blocks. A large block cache setting can speed up reading. Generally  it is recommended to set the block cache size to 30%-50% of <code>tikv.resources.limits.memory</code><br>If TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tikv.config</code>:<br><code>[rocksdb.defaultcf]</code><br><code>block-cache-size = &quot;1GB&quot;</code><br>Since TiKV v3.0.0, it is no longer necessary to configure <code>[rocksdb.defaultcf].block-cache-size</code> and <code>[rocksdb.writecf].block-cache-size</code>. Instead, you can configure <code>[storage.block-cache].capacity</code>.</td><td align="left"><code>1GB</code></td></tr><tr><td align="left"><code>tikv.writecfBlockCacheSize</code></td><td align="left">Specifies the block cache size of <code>writecf</code>. It is generally recommended to be 10%-30% of <code>tikv.resources.limits.memory</code><br> If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tikv.config</code>:<br><code>[rocksdb.writecf]</code><br><code>block-cache-size = &quot;256MB&quot;</code><br>Since TiKV v3.0.0, it is no longer necessary to configure <code>[rocksdb.defaultcf].block-cache-size</code> and <code>[rocksdb.writecf].block-cache-size</code>. Instead, you can configure <code>[storage.block-cache].capacity</code></td><td align="left"><code>256MB</code></td></tr><tr><td align="left"><code>tikv.readpoolStorageConcurrency</code></td><td align="left">Size of TiKV storage thread pool for high/medium/low priority operations<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tikv.config</code>:<br><code>[readpool.storage]</code><br><code>high-concurrency = 4</code><br><code>normal-concurrency = 4</code><br><code>low-concurrency = 4</code></td><td align="left"><code>4</code></td></tr><tr><td align="left"><code>tikv.readpoolCoprocessorConcurrency</code></td><td align="left">Usually, if <code>tikv.resources.limits.cpu</code> &gt; 8, set <code>tikv.readpoolCoprocessorConcurrency</code> to <code>tikv.resources.limits.cpu</code> * 0.8<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tikv.config</code>:<br><code>[readpool.coprocessor]</code><br><code>high-concurrency = 8</code><br><code>normal-concurrency = 8</code><br><code>low-concurrency = 8</code></td><td align="left"><code>8</code></td></tr><tr><td align="left"><code>tikv.storageSchedulerWorkerPoolSize</code></td><td align="left">Size of the working pool of the TiKV scheduler, which should be increased in the case of rewriting, and should be smaller than the total CPU cores.<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tikv.config</code>:<br><code>[storage]</code><br><code>scheduler-worker-pool-size = 4</code></td><td align="left"><code>4</code></td></tr><tr><td align="left"><code>tidb.config</code></td><td align="left">Configuration of TiDB in configuration file format. To view the default TiDB configuration file, refer to <a href="https://github.com/pingcap/tidb/blob/master/config/config.toml.example" target="_blank" rel="noopener noreferrer">configuration file</a> and select the tag of the corresponding TiDB version. To view the descriptions of parameters, refer to <a href="https://pingcap.com/docs/stable/reference/configuration/tidb-server/configuration-file" target="_blank" rel="noopener noreferrer">TiDB configuration description</a> and select the corresponding document version. Here you only need to modify the configuration <strong>according to the format in the configuration file</strong>.<br><br>The following configuration items need to be configured explicitly:<br><br><code>[performance]</code><br>Â <!-- -->Â <code>max-procs = 0</code><br>Recommended: set <code>max-procs</code> to the number of cores that correspondes to <code>tidb.resources.limits.cpu</code></td><td align="left">If the TiDB Operator version &lt;= v1.0.0-beta.3, the default value is:<br><code>nil</code><br>If the TiDB Operator version &gt; v1.0.0-beta.3, the default value is:<br><code>[log]</code><br><code>level = &quot;info&quot;</code><br>For example:<br>Â <!-- -->Â <code>config:</code> <!-- -->|<br>Â <!-- -->Â <!-- -->Â <!-- -->Â <code>[log]</code><br>Â <!-- -->Â <!-- -->Â <!-- -->Â <code>level = &quot;info&quot;</code></td></tr><tr><td align="left"><code>tidb.replicas</code></td><td align="left">Number of Pods in TiDB</td><td align="left"><code>2</code></td></tr><tr><td align="left"><code>tidb.image</code></td><td align="left">Image of TiDB</td><td align="left"><code>pingcap/tidb:v3.0.0-rc.1</code></td></tr><tr><td align="left"><code>tidb.imagePullPolicy</code></td><td align="left">Pull strategy for TiDB image</td><td align="left"><code>IfNotPresent</code></td></tr><tr><td align="left"><code>tidb.logLevel</code></td><td align="left">TiDB log level.<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tidb.config</code>:<br><code>[log]</code><br><code>level = &quot;info&quot;</code></td><td align="left"><code>info</code></td></tr><tr><td align="left"><code>tidb.resources.limits.cpu</code></td><td align="left">CPU resource limits for each TiDB Pod</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>tidb.resources.limits.memory</code></td><td align="left">Memory resource limit for each TiDB Pod</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>tidb.resources.requests.cpu</code></td><td align="left">Storage capacity limit for each TiDB Pod</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>tidb.resources.requests.memory</code></td><td align="left">Memory resource request for each TiDB Pod</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>tidb.passwordSecretName</code></td><td align="left">The name of the Secret which stores the TiDB username and password. This Secret can be created with the following command: <code>kubectl create secret generic tidb secret--from literal=root=${password}--namespace=${namespace}</code>. If the parameter is not set, the TiDB root password is empty.</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>tidb.initSql</code></td><td align="left">The initialization script that will be executed after the TiDB cluster is successfully started.</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>tidb.affinity</code></td><td align="left"><code>tidb.affinity</code> defines the scheduling rules and preferences of TiDB. For details, refer to <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#affinity-and-anti-affinity" target="_blank" rel="noopener noreferrer">affinity-and-anti-affinity</a>.</td><td align="left"><code>{}</code></td></tr><tr><td align="left"><code>tidb.nodeSelector</code></td><td align="left"><code>tidb.nodeSelector</code> makes sure that TiDB Pods are only dispatched to nodes that have this key-value pair as a label. For details, refer to<a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector" target="_blank" rel="noopener noreferrer">nodeselector</a>.</td><td align="left"><code>{}</code></td></tr><tr><td align="left"><code>tidb.tolerations</code></td><td align="left"><code>tidb.tolerations</code> applies to TiKV Pods, allowing TiKV Pods to be dispatched to nodes with specified taints. For details, refer to <a href="https://kubernetes.io/docs/concepts/configuration/taint-and-toleration" target="_blank" rel="noopener noreferrer">taint-and-toleration</a>.</td><td align="left"><code>{}</code></td></tr><tr><td align="left"><code>tidb.annotations</code></td><td align="left">Add specific <code>annotations</code> for TiDB Pods</td><td align="left"><code>{}</code></td></tr><tr><td align="left"><code>tidb.maxFailoverCount</code></td><td align="left">The maximum number of failover in TiDB. If it is set to 3, then TiDB supports at most 3 instances failover at the same time.</td><td align="left"><code>3</code></td></tr><tr><td align="left"><code>tidb.service.type</code></td><td align="left">Type of the service exposed by TiDB</td><td align="left"><code>NodePort</code></td></tr><tr><td align="left"><code>tidb.service.externalTrafficPolicy</code></td><td align="left">Indicates whether this service wants to route external traffic to a local node or a cluster-wide endpoint. Two options are available: <code>Cluster</code> (default) and <code>Local</code>. <code>Cluster</code> hides the client&#x27;s source IP. In such case, the traffic might need to be redirected to another node, but has a good overall load distribution. <code>Local</code> retains the client&#x27;s source IP and avoids the redirection of traffic of the LoadBalancer and NodePort service, but a potential risk of unbalanced traffic propagation exists. For details, refer to <a href="https://kubernetes.io/docs/tasks/access-application-cluster/create-external-load-balancer/#preserving-the-client-source-ip" target="_blank" rel="noopener noreferrer">External Load Balancer</a>.</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>tidb.service.loadBalancerIP</code></td><td align="left">Specifies TiDB load balancing IP. Some cloud service providers allow you to specify the loadBalancer IP. In these cases, a load balancer is created using a user-specified loadBalancerIP. If the loadBalancerIP field is not specified, the loadBalancer is set with a temporary IP address. If loadBalancerIP is specified but the cloud provider does not support this feature, the loadBalancerIP field you set is ignored.</td><td align="left"><code>nil</code></td></tr><tr><td align="left"><code>tidb.service.mysqlNodePort</code></td><td align="left">MySQL NodePort port exposed by the TiDB service</td><td align="left">/</td></tr><tr><td align="left"><code>tidb.service.exposeStatus</code></td><td align="left">Whether the TiDB service exposes the status port</td><td align="left"><code>true</code></td></tr><tr><td align="left"><code>tidb.service.statusNodePort</code></td><td align="left">Specifies the <code>NodePort</code> where the status port of the TiDB service is exposed</td><td align="left">/</td></tr><tr><td align="left"><code>tidb.separateSlowLog</code></td><td align="left">Whether to run a standalone container in sidecar mode to output TiDB&#x27;s SlowLog</td><td align="left">If the TiDB Operator version &lt;= v1.0.0-beta.3, the default value is <code>false</code>.<br>If the TiDB Operator version &gt; v1.0.0-beta.3, the default value is <code>true</code>.</td></tr><tr><td align="left"><code>tidb.slowLogTailer.image</code></td><td align="left"><code>slowLogTailer</code> image of TiDB. <code>slowLogTailer</code> is a sidecar type container used to output TiDB&#x27;s SlowLog. This configuration only takes effect when <code>tidb.separateSlowLog</code> = <code>true</code>.</td><td align="left"><code>busybox:1.26.2</code></td></tr><tr><td align="left"><code>tidb.slowLogTailer.resources.limits.cpu</code></td><td align="left">CPU resource limit for slowLogTailer of each TiDB Pod</td><td align="left"><code>100m</code></td></tr><tr><td align="left"><code>tidb.slowLogTailer.resources.limits.memory</code></td><td align="left">Memory resource limit for slowLogTailer of each TiDB Pod</td><td align="left"><code>50Mi</code></td></tr><tr><td align="left"><code>tidb.slowLogTailer.resources.requests.cpu</code></td><td align="left">CPU resource request for slowLogTailer of each TiDB Pod</td><td align="left"><code>20m</code></td></tr><tr><td align="left"><code>tidb.slowLogTailer.resources.requests.memory</code></td><td align="left">Memory resource request for slowLogTailer of each TiDB Pod</td><td align="left"><code>5Mi</code></td></tr><tr><td align="left"><code>tidb.plugin.enable</code></td><td align="left">Whether to enable the TiDB plugin feature</td><td align="left"><code>false</code></td></tr><tr><td align="left"><code>tidb.plugin.directory</code></td><td align="left">Specifies the directory of the TiDB plugin</td><td align="left"><code>/plugins</code></td></tr><tr><td align="left"><code>tidb.plugin.list</code></td><td align="left">Specifies the list of plugins loaded by TiDB. Rules of naming Plugin ID: <!-- -->[plugin name]<!-- -->-<!-- -->[version]<!-- -->. For example: &#x27;conn_limit-1&#x27;</td><td align="left"><code>[]</code></td></tr><tr><td align="left"><code>tidb.preparedPlanCacheEnabled</code></td><td align="left">Whether to enable the prepared plan cache of TiDB.<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tidb.config</code>:<br><code>[prepared-plan-cache]</code><br><code>enabled = false</code></td><td align="left"><code>false</code></td></tr><tr><td align="left"><code>tidb.preparedPlanCacheCapacity</code></td><td align="left">Number of the prepared plan cache of TiDB.<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tidb.config</code>:<br><code>[prepared-plan-cache]</code><br><code>capacity = 100</code></td><td align="left"><code>100</code></td></tr><tr><td align="left"><code>tidb.txnLocalLatchesEnabled</code></td><td align="left">Whether to enable the transaction memory lock. It is recommended to enable the transaction memory lock when there are many local transaction conflicts.<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tidb.config</code>:<br><code>[txn-local-latches]</code><br><code>enabled = false</code></td><td align="left"><code>false</code></td></tr><tr><td align="left"><code>tidb.txnLocalLatchesCapacity</code></td><td align="left">Capacity of the transaction memory lock. The number of slots corresponding to the hash is automatically adjusted up to an exponential multiple of 2. Every slot occupies 32 bytes of memory. When the range of data to be written is wide (such as importing data), setting a small capacity causes performance degradation.<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tidb.config</code>:<br><code>[txn-local-latches]</code><br><code>capacity = 10240000</code></td><td align="left"><code>10240000</code></td></tr><tr><td align="left"><code>tidb.tokenLimit</code></td><td align="left">Limit for concurrent sessions executed by TiDB<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tidb.config</code>:<br><code>token-limit = 1000</code></td><td align="left"><code>1000</code></td></tr><tr><td align="left"><code>tidb.memQuotaQuery</code></td><td align="left">Memory limit for TiDB query. 32GB by default.<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tidb.config</code>:<br><code>mem-quota-query = 34359738368</code></td><td align="left"><code>34359738368</code></td></tr><tr><td align="left"><code>tidb.checkMb4ValueInUtf8</code></td><td align="left">Determines whether to check <code>mb4</code> characters when the current character set is <code>uff8</code>.<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tidb.config</code>:<br><code>check-mb4-value-in-utf8 = true</code></td><td align="left"><code>true</code></td></tr><tr><td align="left"><code>tidb.treatOldVersionUtf8AsUtf8mb4</code></td><td align="left">Used to upgrade compatibility. If this parameter is set to <code>true</code>, the <code>utf8</code> character set in the old version of tables/columns is treated as the <code>utf8mb4</code> character set.<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tidb.config</code>:<br><code>treat-old-version-utf8-as-utf8mb4 = true</code></td><td align="left"><code>true</code></td></tr><tr><td align="left"><code>tidb.lease</code></td><td align="left">Term of TiDB Schema lease. It is very dangerous to change this parameter, so do not change it unless you know the possible consequences.<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tidb.config</code>:<br><code>lease = &quot;45s&quot;</code></td><td align="left"><code>45s</code></td></tr><tr><td align="left"><code>tidb.maxProcs</code></td><td align="left">The maximum number of CPU cores that are available. 0 represents the total number of CPUs on the machine or Pod.<br>If the TiDB Operator version &gt; v1.0.0-beta.3, configure in <code>tidb.config</code>:<br><code>[performance]</code><br><code>max-procs = 0</code></td><td align="left"><code>0</code></td></tr></tbody></table></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/tidb-cluster-chart-config.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/configure-tidb-binlog-drainer"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">TiDB Binlog Drainer Configurations in Kubernetes</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/configure-backup"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configuration of tidb-backup Chart</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#parameters" class="table-of-contents__link toc-highlight">Parameters</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/">User Manual</a></li><li class="footer__item"><a class="footer__link-item" href="/architecture">Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/tidb" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://tidb.io" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>tidb.io<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/pingcap" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/pingcap/tidb-operator" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Source Code<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 TiDB in Kubernetes Docs, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.c82b2755.js"></script>
<script src="/assets/js/main.1f32aa1c.js"></script>
</body>
</html>